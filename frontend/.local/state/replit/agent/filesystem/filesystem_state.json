{"file_contents":{"src/pages/admin/Subjects.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Modal,\n  Form,\n  Input,\n  Table,\n  Space,\n  message,\n  Select,\n} from 'antd';\nimport Search from 'antd/es/input/Search';\nimport {\n  createSubject,\n  deleteSubject,\n  listClasses,\n  listSubjects,\n} from '../../api/admin';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\n\nexport default function Subjects() {\n  const navigate = useNavigate();\n  const [data, setData] = useState<any[]>([]);\n  const [search, setSearch] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [form] = Form.useForm();\n  const [classOptions, setClassOptions] = useState<\n    { label: string; value: string }[]\n  >([]);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await listSubjects();\n      setData(res.subjects || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load subjects');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const res = await listClasses();\n        const opts = (res.classes || []).map((c: any) => ({\n          label: `${c.name} (${c.classCode || c.code})`,\n          value: c.classCode || c.code,\n        }));\n        setClassOptions(opts);\n      } catch (e) {\n        // non-blocking\n      }\n    })();\n  }, []);\n\n  const onCreate = () => {\n    form.resetFields();\n    setModalOpen(true);\n  };\n\n  const onSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      await createSubject(values);\n      message.success('Created');\n      setModalOpen(false);\n      fetchData();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n\n  const onDeleteRow = async (record: any) => {\n    try {\n      await deleteSubject(record._id);\n      message.success('Deleted');\n      fetchData();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <BackButton />\n      <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n        <h3>Subjects</h3>\n        <Button type=\"primary\" onClick={onCreate}>\n          Add Subject\n        </Button>\n      </Space>\n      <Search\n        placeholder=\"Search by name or subject code\"\n        allowClear\n        onChange={(e) => setSearch(e.target.value)}\n        style={{ maxWidth: 420 }}\n      />\n      <Table\n        rowKey=\"_id\"\n        loading={loading}\n        dataSource={\n          search\n            ? data.filter((s) => {\n                const name = (s.name || '').toLowerCase();\n                const code = (s.subjectCode || s.code || '').toLowerCase();\n                const q = search.toLowerCase();\n                return name.includes(q) || code.includes(q);\n              })\n            : data\n        }\n        scroll={{ x: true }}\n        columns={[\n          { title: 'Name', dataIndex: 'name' },\n          {\n            title: 'Subject Code',\n            dataIndex: 'subjectCode',\n            render: (_: any, r: any) => r.subjectCode || r.code,\n          },\n          {\n            title: 'Actions',\n            render: (_: any, record: any) => (\n              <Space>\n                <Button danger onClick={() => onDeleteRow(record)}>\n                  Delete\n                </Button>\n              </Space>\n            ),\n          },\n        ]}\n      />\n      <Modal\n        title=\"Create Subject\"\n        open={modalOpen}\n        onOk={onSubmit}\n        onCancel={() => setModalOpen(false)}\n        destroyOnClose\n      >\n        <Form form={form} layout=\"vertical\">\n          <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"subjectCode\"\n            label=\"Subject Code\"\n            rules={[{ required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"classCode\"\n            label=\"Class\"\n            rules={[{ required: true }]}\n          >\n            <Select\n              options={classOptions}\n              placeholder=\"Select class\"\n              showSearch\n              optionFilterProp=\"label\"\n            />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </Space>\n  );\n}\n","size_bytes":4530},"src/pages/teacher/CheckAttendance.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Select,\n  Button,\n  Space,\n  Table,\n  message,\n  Spin,\n  DatePicker,\n  TimePicker,\n  Card,\n  Row,\n  Col,\n  Input,\n} from 'antd';\nimport {\n  getMyClasses,\n  getMySubjects,\n  checkAttendance,\n  markAttendance,\n} from '../../api/teacher';\nimport moment from 'moment';\nimport { useSearchParams } from 'react-router-dom';\nimport { useGlobalLoading } from '../../context/LoadingContext';\n\nexport default function CheckAttendance() {\n  const [classes, setClasses] = useState<any[]>([]);\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [attendance, setAttendance] = useState<any[]>([]);\n  const [stats, setStats] = useState<any | null>(null);\n  const [classId, setClassId] = useState<string | null>(null);\n  const [subjectId, setSubjectId] = useState<string | null>(null);\n  const [roomId, setRoomId] = useState<string>('');\n  const [date, setDate] = useState<any>(moment());\n  const [time, setTime] = useState<any>(moment());\n  const [searchParams] = useSearchParams();\n  const loadingCtx = useGlobalLoading();\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const [cRes, sRes] = await Promise.all([\n          getMyClasses(),\n          getMySubjects(),\n        ]);\n        setClasses(cRes.classes || []);\n        setSubjects(sRes.subjects || []);\n        const preClass = searchParams.get('classId');\n        if (preClass) setClassId(preClass);\n      } catch (e: any) {\n        message.error('Failed to load data');\n      }\n    })();\n  }, []);\n\n  const onCheck = async () => {\n    if (!classId || !subjectId || !roomId) {\n      message.error('Select class, subject and enter room id');\n      return;\n    }\n    setLoading(true);\n    loadingCtx.show();\n    try {\n      const data = await checkAttendance(classId, subjectId, roomId);\n      setAttendance(data.attendanceList || []);\n      setStats(data.stats || null);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Check failed');\n    } finally {\n      setLoading(false);\n      loadingCtx.hide();\n    }\n  };\n\n  const onMark = async () => {\n    if (!classId || !subjectId || !roomId) {\n      message.error('Missing selection');\n      return;\n    }\n    if (!attendance || attendance.length === 0) {\n      message.error('Nothing to save');\n      return;\n    }\n    const payload = {\n      attendanceList: attendance.map((a) => ({ _id: a._id, status: a.status })),\n      subjectId,\n      date: date.format('YYYY-MM-DD'),\n      time: time.format('HH:mm:ss'),\n    };\n    setLoading(true);\n    loadingCtx.show();\n    try {\n      await markAttendance(classId, subjectId, roomId, payload);\n      message.success('Attendance saved');\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Save failed');\n    } finally {\n      setLoading(false);\n      loadingCtx.hide();\n    }\n  };\n\n  const toggleStatus = (record: any) => {\n    setAttendance((prev) =>\n      prev.map((r) =>\n        r._id === record._id\n          ? { ...r, status: r.status === 'Present' ? 'Absent' : 'Present' }\n          : r\n      )\n    );\n  };\n\n  const columns = [\n    { title: 'Name', dataIndex: 'name' },\n    { title: 'Roll No', dataIndex: 'rollNo' },\n    {\n      title: 'Status',\n      render: (_: any, r: any) => (\n        <Button\n          onClick={() => toggleStatus(r)}\n          type={r.status === 'Present' ? 'primary' : 'default'}\n        >\n          {r.status}\n        </Button>\n      ),\n    },\n  ];\n\n  return (\n    <div>\n      <h3>Check Attendance</h3>\n      <Card style={{ marginBottom: 12 }}>\n        <Row gutter={12}>\n          <Col>\n            <Select\n              style={{ minWidth: 220 }}\n              placeholder=\"Select class\"\n              value={classId || undefined}\n              onChange={(v) => setClassId(v)}\n              options={(classes || []).map((c) => ({\n                label: c.name + ' (' + (c.classCode || '') + ')',\n                value: c._id,\n              }))}\n            />\n          </Col>\n          <Col>\n            <Select\n              style={{ minWidth: 220 }}\n              placeholder=\"Select subject\"\n              value={subjectId || undefined}\n              onChange={(v) => setSubjectId(v)}\n              options={(subjects || []).map((s) => ({\n                label: s.name + ' (' + (s.subjectCode || '') + ')',\n                value: s._id,\n              }))}\n            />\n          </Col>\n          <Col>\n            <Input\n              placeholder=\"Room Id\"\n              value={roomId}\n              onChange={(e) => setRoomId(e.target.value)}\n            />\n          </Col>\n          <Col>\n            <DatePicker value={date} onChange={(d) => setDate(d)} />\n          </Col>\n          <Col>\n            <TimePicker value={time} onChange={(t) => setTime(t)} />\n          </Col>\n          <Col>\n            <Space>\n              <Button onClick={onCheck} type=\"primary\" loading={loading}>\n                Check\n              </Button>\n              <Button\n                onClick={onMark}\n                disabled={!attendance || attendance.length === 0}\n                loading={loading}\n              >\n                Mark Attendance\n              </Button>\n            </Space>\n          </Col>\n        </Row>\n      </Card>\n\n      {loading ? (\n        <Spin />\n      ) : (\n        <>\n          {stats && (\n            <Card style={{ marginBottom: 12 }}>\n              <div>Faces detected: {stats.faces_detected}</div>\n              <div>Unrecognized faces: {stats.unrecognized_faces}</div>\n              <div>Present: {stats.students_present}</div>\n              <div>Absent: {stats.students_absent}</div>\n            </Card>\n          )}\n\n          <Table rowKey=\"_id\" dataSource={attendance} columns={columns} />\n        </>\n      )}\n    </div>\n  );\n}\n","size_bytes":5832},"src/pages/admin/Classes.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Button, Modal, Form, Input, Space, message, Row, Col, Card, Typography } from 'antd';\nimport { useNavigate } from 'react-router-dom';\nimport { createClass, deleteClass, listClasses } from '../../api/admin';\n\nexport default function Classes() {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await listClasses();\n      setData(res.classes || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load classes');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => { fetchData(); }, []);\n\n  const onCreate = () => {\n    form.resetFields();\n    setModalOpen(true);\n  };\n\n  const onSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      await createClass(values);\n      message.success('Created');\n      setModalOpen(false);\n      fetchData();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n\n  const onDeleteRow = async (record: any) => {\n    try {\n      await deleteClass(record._id);\n      message.success('Deleted');\n      fetchData();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n        <h3>Classes</h3>\n        <Button type=\"primary\" onClick={onCreate}>Add Class</Button>\n      </Space>\n      <Row gutter={[16, 16]}>\n        {data.map((c) => (\n          <Col xs={24} sm={12} md={8} lg={6} key={c._id}>\n            <Card\n              hoverable\n              loading={loading}\n              onClick={() => navigate(`/admin/classes/${c._id}`)}\n            >\n              <Typography.Title level={5} style={{ marginBottom: 4 }}>{c.name}</Typography.Title>\n              <Typography.Text type=\"secondary\">Code: {c.classCode}</Typography.Text>\n              <div style={{ marginTop: 12 }}>\n                <Button danger size=\"small\" onClick={(e) => { e.stopPropagation(); onDeleteRow(c); }}>Delete</Button>\n              </div>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n      <Modal\n        title=\"Create Class\"\n        open={modalOpen}\n        onOk={onSubmit}\n        onCancel={() => setModalOpen(false)}\n        destroyOnClose\n      >\n        <Form form={form} layout=\"vertical\">\n          <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item name=\"classCode\" label=\"Code\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </Space>\n  );\n}\n\n\n","size_bytes":2984},"src/pages/student/StudentSummary.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Card,\n  Typography,\n  Space,\n  Table,\n  Divider,\n  Spin,\n  Alert,\n  Progress,\n} from 'antd';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport { getMyAttendanceSummary } from '../../api/student';\n\ntype SummaryRow = {\n  _id?: string;\n  name?: string;\n  subject?: string;\n  subjectCode?: string;\n  presentCount?: number;\n  present?: number;\n  absentCount?: number;\n  absent?: number;\n  totalClasses: number;\n  attendancePercentage?: number | string;\n  presentPercentage?: number | string;\n};\n\nexport default function StudentSummary() {\n  const navigate = useNavigate();\n  const [summary, setSummary] = useState<SummaryRow[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const data = await getMyAttendanceSummary();\n        setSummary(data.summary || []);\n        setErr(null);\n      } catch (e: any) {\n        setErr(\n          e?.response?.data?.message || e?.message || 'Failed to load summary'\n        );\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  const columns = [\n    {\n      title: 'Subject',\n      dataIndex: 'name',\n      key: 'subject',\n      width: 150,\n    },\n    {\n      title: 'Present',\n      dataIndex: 'present',\n      key: 'present',\n      width: 80,\n      align: 'center' as const,\n      render: (val: any, record: any) =>\n        record.present || record.presentCount || 0,\n    },\n    {\n      title: 'Absent',\n      dataIndex: 'absent',\n      key: 'absent',\n      width: 80,\n      align: 'center' as const,\n      render: (val: any, record: any) =>\n        record.absent || record.absentCount || 0,\n    },\n    {\n      title: 'Total',\n      dataIndex: 'totalClasses',\n      key: 'totalClasses',\n      width: 80,\n      align: 'center' as const,\n    },\n    {\n      title: 'Attendance %',\n      dataIndex: 'presentPercentage',\n      key: 'presentPercentage',\n      width: 150,\n      align: 'center' as const,\n      render: (pct: number | string | undefined, record: any) => {\n        const percentage = Math.round(\n          Number(pct || record.attendancePercentage || 0)\n        );\n        const color =\n          percentage >= 75\n            ? '#22c55e'\n            : percentage >= 50\n            ? '#f59e0b'\n            : '#ef4444';\n        return (\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <Progress\n              type=\"circle\"\n              percent={percentage}\n              size={40}\n              strokeColor={color}\n            />\n            <span style={{ fontWeight: 600 }}>{percentage}%</span>\n          </div>\n        );\n      },\n    },\n  ];\n\n  const tableData = summary.map((s, idx) => ({ ...s, key: idx }));\n\n  if (loading) return <Spin />;\n  if (err)\n    return <Alert type=\"error\" message={err} style={{ marginBottom: 16 }} />;\n\n  // Calculate overall\n  const totalPresent = summary.reduce(\n    (s, r) => s + (r.present || r.presentCount || 0),\n    0\n  );\n  const totalAbsent = summary.reduce(\n    (s, r) => s + (r.absent || r.absentCount || 0),\n    0\n  );\n  const totalClasses = summary.reduce((s, r) => s + (r.totalClasses || 0), 0);\n  const overallAvg =\n    totalClasses > 0 ? Math.round((totalPresent / totalClasses) * 100) : 0;\n\n  return (\n    <div>\n      <BackButton />\n      <Typography.Title level={3}>Attendance Summary</Typography.Title>\n\n      {/* OVERALL STATS */}\n      <Card style={{ marginBottom: 24 }}>\n        <div\n          style={{\n            display: 'grid',\n            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',\n            gap: 12,\n          }}\n        >\n          <Card\n            style={{\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n              color: '#fff',\n              textAlign: 'center',\n              border: 'none',\n            }}\n          >\n            <div style={{ fontSize: 32, fontWeight: 'bold' }}>\n              {totalClasses}\n            </div>\n            <div style={{ fontSize: 12 }}>Total Classes</div>\n          </Card>\n\n          <Card\n            style={{\n              background: 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',\n              color: '#fff',\n              textAlign: 'center',\n              border: 'none',\n            }}\n          >\n            <div style={{ fontSize: 32, fontWeight: 'bold' }}>\n              {totalPresent}\n            </div>\n            <div style={{ fontSize: 12 }}>Present</div>\n          </Card>\n\n          <Card\n            style={{\n              background: 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',\n              color: '#fff',\n              textAlign: 'center',\n              border: 'none',\n            }}\n          >\n            <div style={{ fontSize: 32, fontWeight: 'bold' }}>\n              {totalAbsent}\n            </div>\n            <div style={{ fontSize: 12 }}>Absent</div>\n          </Card>\n\n          <Card\n            style={{\n              background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',\n              color: '#fff',\n              textAlign: 'center',\n              border: 'none',\n            }}\n          >\n            <div style={{ fontSize: 32, fontWeight: 'bold' }}>\n              {overallAvg}%\n            </div>\n            <div style={{ fontSize: 12 }}>Attendance</div>\n          </Card>\n        </div>\n      </Card>\n\n      {/* DETAILED TABLE */}\n      <Card>\n        <Space direction=\"vertical\" style={{ width: '100%' }} size=\"large\">\n          <Typography.Title level={4} style={{ margin: 0 }}>\n            Subject-wise Breakdown\n          </Typography.Title>\n          <Divider />\n          {summary.length === 0 ? (\n            <Typography.Text type=\"secondary\">\n              No summary data available\n            </Typography.Text>\n          ) : (\n            <Table\n              columns={columns}\n              dataSource={tableData}\n              pagination={{ pageSize: 15 }}\n              scroll={{ x: 600 }}\n            />\n          )}\n        </Space>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6160},"vite.config.ts":{"content":"import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [react()],\n  server: {\n    host: '0.0.0.0',\n    port: 5000,\n    allowedHosts: ['*'],\n    hmr: {\n      clientPort: 443,\n    },\n  }\n});\n\n","size_bytes":286},"src/pages/admin/Rooms.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Button, Modal, Form, Input, Table, Space, message } from 'antd';\nimport Search from 'antd/es/input/Search';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport { createRoom, deleteRoom, listRooms, updateRoom } from '../../api/admin';\n\nexport default function Rooms() {\n  const navigate = useNavigate();\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [editing, setEditing] = useState<any | null>(null);\n  const [form] = Form.useForm();\n  const [search, setSearch] = useState('');\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await listRooms();\n      setData(res.rooms || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load rooms');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const onCreate = () => {\n    setEditing(null);\n    form.resetFields();\n    setModalOpen(true);\n  };\n  const onEdit = (record: any) => {\n    setEditing(record);\n    const firstCam = (record.cameras || [])[0] || {};\n    form.setFieldsValue({\n      name: record.name,\n      description: record.description,\n      cameraId: firstCam.cameraId,\n      cameraAccessLink: firstCam.cameraAccessLink,\n    });\n    setModalOpen(true);\n  };\n  const onDelete = async (record: any) => {\n    try {\n      await deleteRoom(record._id);\n      message.success('Deleted');\n      fetchData();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  const onSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      if (editing) {\n        await updateRoom(editing._id, {\n          name: values.name,\n          description: values.description,\n          camera: {\n            cameraId: values.cameraId,\n            cameraAccessLink: values.cameraAccessLink,\n          },\n        });\n        message.success('Updated');\n      } else {\n        await createRoom({\n          name: values.name,\n          description: values.description,\n          camera: {\n            cameraId: values.cameraId,\n            cameraAccessLink: values.cameraAccessLink,\n          },\n        });\n        message.success('Created');\n      }\n      setModalOpen(false);\n      fetchData();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <BackButton />\n      <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n        <h3>Rooms</h3>\n        <Button type=\"primary\" onClick={onCreate}>\n          Add Room\n        </Button>\n      </Space>\n      <Search\n        placeholder=\"Search by name, camera ID, or description\"\n        allowClear\n        onChange={(e) => setSearch(e.target.value)}\n        style={{ maxWidth: 420 }}\n      />\n      <Table\n        rowKey=\"_id\"\n        loading={loading}\n        dataSource={\n          search\n            ? data.filter((r: any) => {\n                const name = (r.name || '').toLowerCase();\n                const desc = (r.description || '').toLowerCase();\n                const camIds = (r.cameras || [])\n                  .map((c: any) => c.cameraId || '')\n                  .join(' ')\n                  .toLowerCase();\n                const q = search.toLowerCase();\n                return (\n                  name.includes(q) || desc.includes(q) || camIds.includes(q)\n                );\n              })\n            : data\n        }\n        scroll={{ x: true }}\n        columns={[\n          { title: 'Name', dataIndex: 'name' },\n          {\n            title: 'Cameras',\n            dataIndex: 'cameras',\n            render: (cams: any[]) => cams?.length ?? 0,\n          },\n          {\n            title: 'Actions',\n            render: (_: any, record: any) => (\n              <Space>\n                <Button onClick={() => onEdit(record)}>Edit</Button>\n                <Button danger onClick={() => onDelete(record)}>\n                  Delete\n                </Button>\n              </Space>\n            ),\n          },\n        ]}\n      />\n      <Modal\n        title={editing ? 'Edit Room' : 'Create Room'}\n        open={modalOpen}\n        onOk={onSubmit}\n        onCancel={() => setModalOpen(false)}\n        destroyOnClose\n      >\n        <Form form={form} layout=\"vertical\">\n          <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"description\"\n            label=\"Description\"\n            rules={[{ required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"cameraId\"\n            label=\"Camera ID\"\n            rules={[{ required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"cameraAccessLink\"\n            label=\"Camera Access Link\"\n            rules={[{ required: true }]}\n          >\n            <Input placeholder=\"http://...\" />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </Space>\n  );\n}\n","size_bytes":5309},"src/pages/admin/ClassDetail.tsx":{"content":"import { useEffect, useMemo, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport {\n  Tabs,\n  Space,\n  Typography,\n  Table,\n  Button,\n  Modal,\n  Form,\n  Input,\n  message,\n} from 'antd';\nimport {\n  createSubject,\n  deleteSubject,\n  listClasses,\n  listStudents,\n  listSubjects,\n} from '../../api/admin';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\n\nexport default function ClassDetail() {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const [clazz, setClazz] = useState<any | null>(null);\n  const [loadingClass, setLoadingClass] = useState(true);\n\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [loadingSubjects, setLoadingSubjects] = useState(false);\n  const [subjectModal, setSubjectModal] = useState(false);\n  const [subjectForm] = Form.useForm();\n\n  const [students, setStudents] = useState<any[]>([]);\n  const [loadingStudents, setLoadingStudents] = useState(false);\n\n  // Load class details (from list, then find by id)\n  useEffect(() => {\n    (async () => {\n      setLoadingClass(true);\n      try {\n        const res = await listClasses();\n        const found = (res.classes || []).find((c: any) => c._id === id);\n        setClazz(found || null);\n      } catch (e: any) {\n        message.error(e?.response?.data?.message || 'Failed to load class');\n      } finally {\n        setLoadingClass(false);\n      }\n    })();\n  }, [id]);\n\n  const classId = id!;\n  const classCode = useMemo(() => clazz?.classCode, [clazz]);\n\n  // Subjects for class (client-side filtered)\n  const fetchSubjects = async () => {\n    setLoadingSubjects(true);\n    try {\n      const res = await listSubjects();\n      const items = (res.subjects || []).filter((s: any) => {\n        // assume subject.class is the object id or populated object\n        const subjClassId =\n          typeof s.class === 'string' ? s.class : s.class?._id;\n        return subjClassId === classId;\n      });\n      setSubjects(items);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load subjects');\n    } finally {\n      setLoadingSubjects(false);\n    }\n  };\n\n  // Students for class (server-side filtered via classCode)\n  const fetchStudents = async () => {\n    if (!classCode) return;\n    setLoadingStudents(true);\n    try {\n      const res = await listStudents({ classCode });\n      setStudents(res.students || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load students');\n    } finally {\n      setLoadingStudents(false);\n    }\n  };\n\n  useEffect(() => {\n    if (classId) fetchSubjects();\n  }, [classId]);\n  useEffect(() => {\n    if (classCode) fetchStudents();\n  }, [classCode]);\n\n  const onCreateSubject = () => {\n    subjectForm.resetFields();\n    if (clazz?.classCode) {\n      subjectForm.setFieldsValue({ classCode: clazz.classCode });\n    }\n    setSubjectModal(true);\n  };\n  const onSubmitSubject = async () => {\n    try {\n      const values = await subjectForm.validateFields();\n      // create with explicit codes per requirements\n      await createSubject(values);\n      message.success('Subject created');\n      setSubjectModal(false);\n      fetchSubjects();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n  const onDeleteSubject = async (record: any) => {\n    try {\n      await deleteSubject(record._id);\n      message.success('Deleted');\n      fetchSubjects();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <BackButton />\n      <Typography.Title level={4} style={{ marginBottom: 0 }}>\n        {loadingClass\n          ? 'Loadingâ€¦'\n          : clazz\n          ? `${clazz.name} (${clazz.classCode})`\n          : 'Class not found'}\n      </Typography.Title>\n      <Tabs\n        items={[\n          {\n            key: 'subjects',\n            label: 'Subjects',\n            children: (\n              <Space direction=\"vertical\" style={{ width: '100%' }}>\n                <Space\n                  style={{ justifyContent: 'space-between', width: '100%' }}\n                >\n                  <Typography.Text strong>\n                    Subjects in this class\n                  </Typography.Text>\n                  <Button type=\"primary\" onClick={onCreateSubject}>\n                    Add Subject\n                  </Button>\n                </Space>\n                <Table\n                  rowKey=\"_id\"\n                  loading={loadingSubjects}\n                  dataSource={subjects}\n                  scroll={{ x: true }}\n                  columns={[\n                    { title: 'Name', dataIndex: 'name' },\n                    {\n                      title: 'Subject Code',\n                      dataIndex: 'subjectCode',\n                      render: (_: any, r: any) => r.subjectCode || r.code,\n                    },\n                    {\n                      title: 'Actions',\n                      render: (_: any, record: any) => (\n                        <Button danger onClick={() => onDeleteSubject(record)}>\n                          Delete\n                        </Button>\n                      ),\n                    },\n                  ]}\n                />\n                <Modal\n                  title=\"Create Subject\"\n                  open={subjectModal}\n                  onOk={onSubmitSubject}\n                  onCancel={() => setSubjectModal(false)}\n                  destroyOnClose\n                >\n                  <Form form={subjectForm} layout=\"vertical\">\n                    <Form.Item\n                      name=\"name\"\n                      label=\"Name\"\n                      rules={[{ required: true }]}\n                    >\n                      <Input />\n                    </Form.Item>\n                    <Form.Item\n                      name=\"subjectCode\"\n                      label=\"Subject Code\"\n                      rules={[{ required: true }]}\n                    >\n                      <Input />\n                    </Form.Item>\n                    <Form.Item\n                      name=\"classCode\"\n                      label=\"Class Code\"\n                      rules={[{ required: true }]}\n                    >\n                      <Input disabled={!!clazz?.code} />\n                    </Form.Item>\n                  </Form>\n                </Modal>\n              </Space>\n            ),\n          },\n          {\n            key: 'students',\n            label: 'Students',\n            children: (\n              <Space direction=\"vertical\" style={{ width: '100%' }}>\n                <Typography.Text strong>Students in this class</Typography.Text>\n                <Table\n                  rowKey=\"_id\"\n                  loading={loadingStudents}\n                  dataSource={students}\n                  scroll={{ x: true }}\n                  columns={[\n                    { title: 'Name', dataIndex: 'name' },\n                    { title: 'Roll No', dataIndex: 'rollNo' },\n                    {\n                      title: 'Email',\n                      dataIndex: ['user', 'email'],\n                      render: (_: any, r: any) => r.user?.email || r.email,\n                    },\n                  ]}\n                />\n              </Space>\n            ),\n          },\n        ]}\n      />\n    </Space>\n  );\n}\n","size_bytes":7471},"src/pages/admin/Students.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Modal,\n  Form,\n  Input,\n  Table,\n  Space,\n  message,\n  Upload,\n  Select,\n} from 'antd';\nimport Search from 'antd/es/input/Search';\nimport { UploadOutlined } from '@ant-design/icons';\nimport {\n  createStudent,\n  deleteStudent,\n  listClasses,\n  listStudents,\n  updateStudent,\n} from '../../api/admin';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\n\nexport default function Students() {\n  const navigate = useNavigate();\n  const [data, setData] = useState<any[]>([]);\n  const [search, setSearch] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [editing, setEditing] = useState<any | null>(null);\n  const [form] = Form.useForm();\n  const [file, setFile] = useState<File | null>(null);\n  const [classOptions, setClassOptions] = useState<\n    { label: string; value: string }[]\n  >([]);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await listStudents();\n      setData(res.students || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load students');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Load classes for dropdown\n  useEffect(() => {\n    (async () => {\n      try {\n        const c = await listClasses();\n        const cOpts = (c.classes || []).map((it: any) => ({\n          label: `${it.name} (${it.classCode || it.code})`,\n          value: it.classCode || it.code,\n        }));\n        setClassOptions(cOpts);\n      } catch (e: any) {\n        // ignore\n      }\n    })();\n  }, []);\n\n  const onCreate = () => {\n    setEditing(null);\n    setFile(null);\n    form.resetFields();\n    setModalOpen(true);\n  };\n\n  const onEdit = (record: any) => {\n    setEditing(record);\n    setFile(null);\n    form.setFieldsValue({\n      name: record.name,\n      classCode: record.class?.code || record.classCode,\n      rollNo: record.rollNo,\n      semester: record.semester,\n      username: record.user?.username || record.username,\n      email: record.user?.email || record.email,\n      phoneNumber: record.phoneNumber,\n    });\n    setModalOpen(true);\n  };\n\n  const onDeleteRow = async (record: any) => {\n    try {\n      await deleteStudent(record._id);\n      message.success('Deleted');\n      fetchData();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  const onSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      const fd = new FormData();\n      Object.entries(values).forEach(([k, v]) => {\n        if (v !== undefined && v !== null) fd.append(k, String(v));\n      });\n      if (file) fd.append('studentImage', file);\n\n      if (editing) {\n        await updateStudent(editing._id, fd);\n        message.success('Updated');\n      } else {\n        if (!file) {\n          message.error('Student image is required.');\n          return;\n        }\n        await createStudent(fd);\n        message.success('Created');\n      }\n      setModalOpen(false);\n      fetchData();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <BackButton />\n      <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n        <h3>Students</h3>\n        <Button type=\"primary\" onClick={onCreate}>\n          Add Student\n        </Button>\n      </Space>\n      <Search\n        placeholder=\"Search by name, roll no, or email\"\n        allowClear\n        onChange={(e) => setSearch(e.target.value)}\n        style={{ maxWidth: 420 }}\n      />\n      <Table\n        rowKey=\"_id\"\n        loading={loading}\n        dataSource={\n          search\n            ? data.filter((s) => {\n                const name = (s.name || '').toLowerCase();\n                const roll = (s.rollNo || '').toLowerCase();\n                const email = (s.user?.email || s.email || '').toLowerCase();\n                const q = search.toLowerCase();\n                return (\n                  name.includes(q) || roll.includes(q) || email.includes(q)\n                );\n              })\n            : data\n        }\n        scroll={{ x: true }}\n        columns={[\n          { title: 'Name', dataIndex: 'name' },\n          { title: 'Roll No', dataIndex: 'rollNo' },\n          {\n            title: 'Class',\n            dataIndex: ['class', 'classCode'],\n            render: (_: any, r: any) => r.class?.classCode || r.classCode,\n          },\n          {\n            title: 'Email',\n            dataIndex: ['user', 'email'],\n            render: (_: any, r: any) => r.user?.email || r.email,\n          },\n          {\n            title: 'Actions',\n            render: (_: any, record: any) => (\n              <Space>\n                <Button onClick={() => onEdit(record)}>Edit</Button>\n                <Button danger onClick={() => onDeleteRow(record)}>\n                  Delete\n                </Button>\n              </Space>\n            ),\n          },\n        ]}\n      />\n\n      <Modal\n        title={editing ? 'Edit Student' : 'Create Student'}\n        open={modalOpen}\n        onOk={onSubmit}\n        onCancel={() => setModalOpen(false)}\n        destroyOnClose\n      >\n        <Form\n          form={form}\n          layout=\"vertical\"\n          onValuesChange={(changed) => {\n            if (changed.rollNo !== undefined) {\n              const rn = changed.rollNo;\n              const current = form.getFieldValue('username');\n              if (!current || current === form.__lastAutoUsername) {\n                form.setFieldsValue({ username: rn });\n                // @ts-ignore\n                form.__lastAutoUsername = rn;\n              }\n            }\n          }}\n        >\n          <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"classCode\"\n            label=\"Class\"\n            rules={[{ required: true }]}\n          >\n            <Select\n              options={classOptions}\n              placeholder=\"Select class\"\n              showSearch\n              optionFilterProp=\"label\"\n            />\n          </Form.Item>\n          <Form.Item\n            name=\"rollNo\"\n            label=\"Roll No\"\n            rules={[{ required: !editing }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"semester\"\n            label=\"Semester\"\n            rules={[{ required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"username\"\n            label=\"Username\"\n            rules={[\n              { required: true },\n              ({ getFieldValue }) => ({\n                validator(_, value) {\n                  const rn = getFieldValue('rollNo');\n                  if (!rn || !value || rn === value) return Promise.resolve();\n                  return Promise.reject(\n                    new Error('Username must match Roll No')\n                  );\n                },\n              }),\n            ]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"email\"\n            label=\"Email\"\n            rules={[{ type: 'email', required: !editing }]}\n          >\n            <Input />\n          </Form.Item>\n          {!editing && (\n            <Form.Item\n              name=\"password\"\n              label=\"Password\"\n              rules={[{ required: true }]}\n            >\n              <Input.Password />\n            </Form.Item>\n          )}\n          <Form.Item label=\"Student Image\">\n            <Upload\n              beforeUpload={(f) => {\n                setFile(f);\n                return false;\n              }}\n              maxCount={1}\n              accept=\"image/*\"\n            >\n              <Button icon={<UploadOutlined />}>Select Image</Button>\n            </Upload>\n          </Form.Item>\n          <Form.Item name=\"phoneNumber\" label=\"Phone Number\">\n            <Input />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </Space>\n  );\n}\n","size_bytes":8230},"src/router/AppRouter.tsx":{"content":"import { Routes, Route, Navigate } from 'react-router-dom';\nimport Landing from '../pages/Landing';\nimport Login from '../pages/Login';\nimport AdminDashboard from '../pages/admin/AdminDashboard';\nimport RoomStream from '../pages/admin/RoomStream';\nimport { ProtectedRoute } from '../components/ProtectedRoute';\nimport AdminLayout from '../layouts/AdminLayout';\nimport Teachers from '../pages/admin/Teachers';\nimport Rooms from '../pages/admin/Rooms';\nimport Classes from '../pages/admin/Classes';\nimport ClassDetail from '../pages/admin/ClassDetail';\nimport Subjects from '../pages/admin/Subjects';\nimport Students from '../pages/admin/Students';\n\n// Teacher imports\nimport TeacherLayout from '../layouts/TeacherLayout';\nimport TeacherDashboard from '../pages/teacher/TeacherDashboard';\nimport MyClasses from '../pages/teacher/MyClasses';\nimport MySubjects from '../pages/teacher/MySubjects';\nimport MarkAttendance from '../pages/teacher/MarkAttendance';\nimport Records from '../pages/teacher/Records';\nimport Summary from '../pages/teacher/Summary';\n\n// Student imports\nimport StudentLayout from '../layouts/StudentLayout';\nimport StudentDashboard from '../pages/student/StudentDashboard';\nimport StudentRecords from '../pages/student/StudentRecords';\n\nexport default function AppRouter() {\n  return (\n    <Routes>\n      <Route path=\"/\" element={<Landing />} />\n      <Route path=\"/login\" element={<Login />} />\n\n      <Route\n        path=\"/admin\"\n        element={\n          <ProtectedRoute roles={['Admin']}>\n            <AdminLayout />\n          </ProtectedRoute>\n        }\n      >\n        <Route index element={<AdminDashboard />} />\n        <Route path=\"stream\" element={<RoomStream />} />\n        <Route path=\"teachers\" element={<Teachers />} />\n        <Route path=\"subjects\" element={<Subjects />} />\n        <Route path=\"rooms\" element={<Rooms />} />\n        <Route path=\"classes\" element={<Classes />} />\n        <Route path=\"classes/:id\" element={<ClassDetail />} />\n        <Route path=\"students\" element={<Students />} />\n      </Route>\n\n      <Route\n        path=\"/teacher\"\n        element={\n          <ProtectedRoute roles={['Teacher']}>\n            <TeacherLayout />\n          </ProtectedRoute>\n        }\n      >\n        <Route index element={<TeacherDashboard />} />\n        <Route path=\"my-classes\" element={<MyClasses />} />\n        <Route path=\"my-subjects\" element={<MySubjects />} />\n        <Route path=\"mark-attendance\" element={<MarkAttendance />} />\n        <Route path=\"records\" element={<Records />} />\n        <Route path=\"summary\" element={<Summary />} />\n      </Route>\n\n      <Route\n        path=\"/student\"\n        element={\n          <ProtectedRoute roles={['Student']}>\n            <StudentLayout />\n          </ProtectedRoute>\n        }\n      >\n        <Route index element={<StudentDashboard />} />\n        <Route path=\"records\" element={<StudentRecords />} />\n      </Route>\n\n      <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n    </Routes>\n  );\n}\n","size_bytes":2998},"src/pages/teacher/MarkAttendance.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Select,\n  Button,\n  Space,\n  Table,\n  message,\n  Spin,\n  Card,\n  Row,\n  Col,\n  Tag,\n} from 'antd';\nimport {\n  getMyClasses,\n  getMySubjects,\n  getAllRooms,\n  checkAttendance,\n  markAttendance,\n} from '../../api/teacher';\nimport moment from 'moment';\nimport { useSearchParams } from 'react-router-dom';\nimport { useGlobalLoading } from '../../context/LoadingContext';\n\ntype FilterType = 'all' | 'present' | 'absent';\n\nexport default function MarkAttendance() {\n  const [classes, setClasses] = useState<any[]>([]);\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [rooms, setRooms] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [attendance, setAttendance] = useState<any[]>([]);\n  const [filteredAttendance, setFilteredAttendance] = useState<any[]>([]);\n  const [stats, setStats] = useState<any | null>(null);\n  const [classId, setClassId] = useState<string | null>(null);\n  const [subjectId, setSubjectId] = useState<string | null>(null);\n  const [roomId, setRoomId] = useState<string | null>(null);\n  const [filter, setFilter] = useState<FilterType>('all');\n  const [searchParams] = useSearchParams();\n  const loadingCtx = useGlobalLoading();\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const [cRes, sRes, rRes] = await Promise.all([\n          getMyClasses(),\n          getMySubjects(),\n          getAllRooms(),\n        ]);\n        setClasses(cRes.classes || []);\n        setSubjects(sRes.subjects || []);\n        setRooms(rRes.rooms || []);\n        const preClass = searchParams.get('classId');\n        if (preClass) setClassId(preClass);\n      } catch (e: any) {\n        message.error('Failed to load data');\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    let filtered = attendance;\n    if (filter === 'present')\n      filtered = attendance.filter((a) => a.status === 'Present');\n    else if (filter === 'absent')\n      filtered = attendance.filter((a) => a.status === 'Absent');\n    setFilteredAttendance(filtered);\n  }, [attendance, filter]);\n\n  const onCheck = async () => {\n    if (!classId || !subjectId || !roomId) {\n      message.error('Select class, subject and room');\n      return;\n    }\n    setLoading(true);\n    loadingCtx.show();\n    try {\n      const data = await checkAttendance(classId, subjectId, roomId);\n      setAttendance(data.attendanceList || []);\n      setStats(data.stats || null);\n      setFilter('all');\n      message.success('Attendance data loaded successfully');\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Check failed');\n    } finally {\n      setLoading(false);\n      loadingCtx.hide();\n    }\n  };\n\n  const onSave = async () => {\n    if (!classId || !subjectId || !roomId) {\n      message.error('Missing selection');\n      return;\n    }\n    if (!attendance || attendance.length === 0) {\n      message.error('Nothing to save');\n      return;\n    }\n    const today = moment();\n    const payload = {\n      attendanceList: attendance.map((a) => ({ _id: a._id, status: a.status })),\n      subjectId,\n      date: today.format('YYYY-MM-DD'),\n      time: today.format('HH:mm:ss'),\n    };\n    setSaving(true);\n    loadingCtx.show();\n    try {\n      await markAttendance(classId, subjectId, roomId, payload);\n      message.success('Attendance saved successfully');\n      setAttendance([]);\n      setStats(null);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Save failed');\n    } finally {\n      setSaving(false);\n      loadingCtx.hide();\n    }\n  };\n\n  const toggleStatus = (record: any) => {\n    setAttendance((prev) =>\n      prev.map((r) =>\n        r._id === record._id\n          ? { ...r, status: r.status === 'Present' ? 'Absent' : 'Present' }\n          : r\n      )\n    );\n  };\n\n  const markAllPresent = () => {\n    setAttendance((prev) => prev.map((r) => ({ ...r, status: 'Present' })));\n    message.info('All marked as Present');\n  };\n\n  const markAllAbsent = () => {\n    setAttendance((prev) => prev.map((r) => ({ ...r, status: 'Absent' })));\n    message.info('All marked as Absent');\n  };\n\n  const columns = [\n    { title: 'Name', dataIndex: 'name', key: 'name' },\n    { title: 'Roll No', dataIndex: 'rollNo', key: 'rollNo' },\n    {\n      title: 'Status',\n      key: 'status',\n      render: (_: any, r: any) => (\n        <Button\n          onClick={() => toggleStatus(r)}\n          type={r.status === 'Present' ? 'primary' : 'default'}\n          danger={r.status === 'Absent'}\n        >\n          {r.status}\n        </Button>\n      ),\n    },\n  ];\n\n  const presentCount = attendance.filter((a) => a.status === 'Present').length;\n  const absentCount = attendance.filter((a) => a.status === 'Absent').length;\n\n  return (\n    <div>\n      <h3>Mark Attendance</h3>\n\n      {/* Selection Card */}\n      <Card style={{ marginBottom: 16 }}>\n        <Row gutter={12} wrap>\n          <Col xs={24} sm={12} md={6}>\n            <Select\n              style={{ width: '100%' }}\n              placeholder=\"Select class\"\n              value={classId || undefined}\n              onChange={(v) => setClassId(v)}\n              options={(classes || []).map((c) => ({\n                label: c.name + ' (' + (c.classCode || '') + ')',\n                value: c._id,\n              }))}\n            />\n          </Col>\n          <Col xs={24} sm={12} md={6}>\n            <Select\n              style={{ width: '100%' }}\n              placeholder=\"Select subject\"\n              value={subjectId || undefined}\n              onChange={(v) => setSubjectId(v)}\n              options={(subjects || []).map((s) => ({\n                label: s.name + ' (' + (s.subjectCode || '') + ')',\n                value: s._id,\n              }))}\n            />\n          </Col>\n          <Col xs={24} sm={12} md={6}>\n            <Select\n              style={{ width: '100%' }}\n              placeholder=\"Select room\"\n              value={roomId || undefined}\n              onChange={(v) => setRoomId(v)}\n              options={(rooms || []).map((r) => ({\n                label:\n                  r.name + ' (' + (r._id?.toString().slice(-4) || '') + ')',\n                value: r._id,\n              }))}\n            />\n          </Col>\n        </Row>\n        <Row gutter={12} style={{ marginTop: 12 }}>\n          <Col>\n            <Button onClick={onCheck} type=\"primary\" loading={loading}>\n              Check Attendance\n            </Button>\n          </Col>\n        </Row>\n      </Card>\n\n      {/* Stats Card */}\n      {stats && (\n        <Card style={{ marginBottom: 16 }}>\n          <Row gutter={16}>\n            <Col xs={12} sm={6}>\n              <div>\n                <strong>Faces Detected:</strong> {stats.faces_detected}\n              </div>\n            </Col>\n            <Col xs={12} sm={6}>\n              <div>\n                <strong>Unrecognized Faces:</strong> {stats.unrecognized_faces}\n              </div>\n            </Col>\n            <Col xs={12} sm={6}>\n              <div>\n                <strong>Present:</strong>{' '}\n                <Tag color=\"green\">{stats.students_present}</Tag>\n              </div>\n            </Col>\n            <Col xs={12} sm={6}>\n              <div>\n                <strong>Absent:</strong>{' '}\n                <Tag color=\"red\">{stats.students_absent}</Tag>\n              </div>\n            </Col>\n          </Row>\n        </Card>\n      )}\n\n      {/* Attendance Edit Card */}\n      {attendance.length > 0 && (\n        <Card style={{ marginBottom: 16 }}>\n          <Row gutter={[12, 12]} align=\"middle\" wrap>\n            <Col>\n              <strong>Filter:</strong>\n            </Col>\n            <Col>\n              <Select\n                style={{ minWidth: 120 }}\n                value={filter}\n                onChange={(v) => setFilter(v)}\n                options={[\n                  { label: 'All', value: 'all' },\n                  { label: 'Present', value: 'present' },\n                  { label: 'Absent', value: 'absent' },\n                ]}\n              />\n            </Col>\n            <Col>\n              <span>\n                Showing {filteredAttendance.length} of {attendance.length}{' '}\n                students\n              </span>\n            </Col>\n            <Col style={{ marginLeft: 'auto' }}>\n              <Space>\n                <Button onClick={markAllPresent} type=\"primary\">\n                  Mark All Present\n                </Button>\n                <Button onClick={markAllAbsent} danger>\n                  Mark All Absent\n                </Button>\n              </Space>\n            </Col>\n          </Row>\n\n          <Row style={{ marginTop: 16 }}>\n            <Col span={24}>\n              <div style={{ marginBottom: 12 }}>\n                <Tag color=\"green\">Present: {presentCount}</Tag>\n                <Tag color=\"red\">Absent: {absentCount}</Tag>\n              </div>\n            </Col>\n          </Row>\n\n          {/* Action Buttons */}\n          <Row gutter={12}>\n            <Col>\n              <Button\n                type=\"primary\"\n                size=\"large\"\n                onClick={onSave}\n                loading={saving}\n                disabled={attendance.length === 0}\n              >\n                Save Attendance\n              </Button>\n            </Col>\n          </Row>\n        </Card>\n      )}\n\n      {/* Table */}\n      {loading ? (\n        <Spin />\n      ) : (\n        attendance.length > 0 && (\n          <Card>\n            <Table\n              rowKey=\"_id\"\n              dataSource={filteredAttendance}\n              columns={columns}\n              pagination={{ pageSize: 10 }}\n              scroll={{ x: 600 }}\n            />\n          </Card>\n        )\n      )}\n    </div>\n  );\n}\n","size_bytes":9749},"src/components/BackButton.tsx":{"content":"import React from 'react';\nimport { Button } from 'antd';\nimport { LeftOutlined } from '@ant-design/icons';\nimport { useNavigate } from 'react-router-dom';\n\ntype BackButtonProps = {\n  children?: React.ReactNode;\n  onClick?: () => void;\n  style?: React.CSSProperties;\n};\n\nexport default function BackButton({\n  children = 'Back',\n  onClick,\n  style,\n}: BackButtonProps) {\n  const navigate = useNavigate();\n  const handle = () => {\n    if (onClick) return onClick();\n    navigate(-1);\n  };\n\n  return (\n    <Button\n      icon={<LeftOutlined />}\n      onClick={handle}\n      style={{ marginBottom: 8, ...style }}\n    >\n      {children}\n    </Button>\n  );\n}\n","size_bytes":653},"src/api/teacher.ts":{"content":"import { http } from './http';\n\nexport async function getMyClasses() {\n  const { data } = await http.get('/teacher/my-classes');\n  return data as { count: number; classes: any[] };\n}\n\nexport async function getMySubjects() {\n  const { data } = await http.get('/teacher/my-subjects');\n  return data as { count: number; subjects: any[] };\n}\n\nexport async function getAllRooms() {\n  const { data } = await http.get('/teacher/rooms');\n  return data as { count: number; rooms: any[] };\n}\n\nexport async function checkAttendance(\n  classId: string,\n  subjectId: string,\n  roomId: string\n) {\n  const { data } = await http.get(\n    `/teacher/check-attendance/${encodeURIComponent(\n      classId\n    )}/${encodeURIComponent(subjectId)}/${encodeURIComponent(roomId)}`\n  );\n  return data as any;\n}\n\nexport async function markAttendance(\n  classId: string,\n  subjectId: string,\n  roomId: string,\n  payload: any\n) {\n  const { data } = await http.post(\n    `/teacher/mark-attendance/${encodeURIComponent(\n      classId\n    )}/${encodeURIComponent(subjectId)}/${encodeURIComponent(roomId)}`,\n    payload\n  );\n  return data as any;\n}\n\nexport async function listRecords(params: {\n  classId: string;\n  subjectId: string;\n  date: string;\n}) {\n  const { data } = await http.get('/teacher/records', { params });\n  return data as any;\n}\n\nexport async function getSummary(params: {\n  classId: string;\n  subjectId: string;\n}) {\n  const { data } = await http.get('/teacher/summary', { params });\n  return data as any;\n}\n\nexport async function updateRecord(\n  id: string,\n  payload: { status: 'Present' | 'Absent' }\n) {\n  const { data } = await http.put(`/teacher/record/${id}`, payload);\n  return data as any;\n}\n","size_bytes":1685},"src/pages/teacher/MyClasses.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Card, Col, Row, Spin, message, Button } from 'antd';\nimport { getMyClasses } from '../../api/teacher';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\n\nexport default function MyClasses() {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await getMyClasses();\n      setData(res.classes || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load classes');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  if (loading) return <Spin />;\n\n  return (\n    <div>\n      <BackButton />\n      <h3>My Classes</h3>\n      <Row gutter={[16, 16]}>\n        {data.map((c) => (\n          <Col xs={24} sm={12} md={8} lg={6} key={c._id}>\n            <Card\n              hoverable\n              onClick={() =>\n                navigate(`/teacher/check-attendance?classId=${c._id}`)\n              }\n            >\n              <div style={{ fontWeight: 600 }}>{c.name}</div>\n              <div style={{ color: '#666' }}>{c.classCode}</div>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </div>\n  );\n}\n","size_bytes":1365},"src/pages/teacher/Records.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Select, Button, Table, DatePicker, message, Space, Spin } from 'antd';\nimport {\n  getMyClasses,\n  getMySubjects,\n  listRecords,\n  updateRecord,\n} from '../../api/teacher';\nimport moment from 'moment';\nimport { useGlobalLoading } from '../../context/LoadingContext';\n\nexport default function Records() {\n  const [classes, setClasses] = useState<any[]>([]);\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [classId, setClassId] = useState<string | null>(null);\n  const [subjectId, setSubjectId] = useState<string | null>(null);\n  const [date, setDate] = useState<any>(moment());\n  const [loading, setLoading] = useState(false);\n  const [records, setRecords] = useState<any[]>([]);\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc'); // desc = highest first\n  const [statusFilter, setStatusFilter] = useState<string | null>(null); // 'Present', 'Absent', or null for all\n  const loadingCtx = useGlobalLoading();\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const [c, s] = await Promise.all([getMyClasses(), getMySubjects()]);\n        setClasses(c.classes || []);\n        setSubjects(s.subjects || []);\n      } catch (e) {}\n    })();\n  }, []);\n\n  const onFetch = async () => {\n    if (!classId || !subjectId || !date) {\n      message.error('Select class, subject and date');\n      return;\n    }\n    setLoading(true);\n    loadingCtx.show();\n    try {\n      const res = await listRecords({\n        classId,\n        subjectId,\n        date: date.format('YYYY-MM-DD'),\n      });\n      setRecords(res.records || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Fetch failed');\n    } finally {\n      setLoading(false);\n      loadingCtx.hide();\n    }\n  };\n\n  const onToggle = async (rec: any) => {\n    const newStatus = rec.status === 'Present' ? 'Absent' : 'Present';\n    loadingCtx.show();\n    try {\n      const res = await updateRecord(rec._id, { status: newStatus });\n      message.success('Updated');\n      setRecords((r) => r.map((it) => (it._id === rec._id ? res.record : it)));\n    } catch (e: any) {\n      message.error(\n        e?.response?.data?.message || e?.message || 'Update failed'\n      );\n    } finally {\n      loadingCtx.hide();\n    }\n  };\n\n  const columns = [\n    {\n      title: 'Name',\n      dataIndex: ['student', 'name'],\n      render: (_: any, r: any) => r.student?.name,\n    },\n    {\n      title: 'Roll No',\n      dataIndex: ['student', 'rollNo'],\n      render: (_: any, r: any) => r.student?.rollNo,\n    },\n    { title: 'Status', dataIndex: 'status' },\n    {\n      title: 'Actions',\n      render: (_: any, r: any) => (\n        <Space>\n          <Button onClick={() => onToggle(r)}>Toggle</Button>\n        </Space>\n      ),\n    },\n  ];\n\n  // Apply filtering and sorting\n  const filteredRecords = records\n    .filter((r) => !statusFilter || r.status === statusFilter)\n    .sort((a, b) => {\n      // For attendance records, we can sort by status (Present/Absent) alphabetically, or by student name\n      // This is a simple alphabetical sort by student name\n      const nameA = a.student?.name || '';\n      const nameB = b.student?.name || '';\n      return sortOrder === 'asc'\n        ? nameA.localeCompare(nameB)\n        : nameB.localeCompare(nameA);\n    });\n\n  return (\n    <div>\n      <h3>Attendance Records</h3>\n      <div style={{ marginBottom: 12 }}>\n        <Select\n          placeholder=\"Class\"\n          style={{ minWidth: 200, marginRight: 8 }}\n          options={(classes || []).map((c) => ({\n            label: c.name,\n            value: c._id,\n          }))}\n          value={classId || undefined}\n          onChange={(v) => setClassId(v)}\n        />\n        <Select\n          placeholder=\"Subject\"\n          style={{ minWidth: 200, marginRight: 8 }}\n          options={(subjects || []).map((s) => ({\n            label: s.name,\n            value: s._id,\n          }))}\n          value={subjectId || undefined}\n          onChange={(v) => setSubjectId(v)}\n        />\n        <DatePicker\n          value={date}\n          onChange={(d) => setDate(d)}\n          style={{ marginRight: 8 }}\n        />\n        <Button type=\"primary\" onClick={onFetch} loading={loading}>\n          Fetch\n        </Button>\n      </div>\n\n      {records.length > 0 && (\n        <div\n          style={{\n            marginBottom: 16,\n            display: 'flex',\n            gap: 12,\n            alignItems: 'center',\n          }}\n        >\n          <Select\n            placeholder=\"Sort By\"\n            style={{ minWidth: 150 }}\n            value={sortOrder}\n            onChange={(v) => setSortOrder(v)}\n            options={[\n              { label: 'Name (A-Z)', value: 'asc' },\n              { label: 'Name (Z-A)', value: 'desc' },\n            ]}\n          />\n          <Select\n            placeholder=\"Filter by Status\"\n            style={{ minWidth: 150 }}\n            allowClear\n            value={statusFilter || undefined}\n            onChange={(v) => setStatusFilter(v)}\n            options={[\n              { label: 'All', value: null },\n              { label: 'Present', value: 'Present' },\n              { label: 'Absent', value: 'Absent' },\n            ]}\n          />\n        </div>\n      )}\n\n      {loading ? (\n        <Spin />\n      ) : (\n        <Table rowKey=\"_id\" dataSource={filteredRecords} columns={columns} />\n      )}\n    </div>\n  );\n}\n","size_bytes":5403},"src/components/ProtectedRoute.tsx":{"content":"import { Navigate } from 'react-router-dom';\nimport { useAuth } from '../auth/AuthContext';\n\nexport function ProtectedRoute({ roles, children }: { roles?: string[]; children: JSX.Element }) {\n  const { user } = useAuth();\n  if (!user) return <Navigate to=\"/login\" replace />;\n  if (roles && (!user.role || !roles.includes(user.role))) return <Navigate to=\"/\" replace />;\n  return children;\n}\n\n\n","size_bytes":394},"src/pages/admin/Teachers.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Modal,\n  Form,\n  Input,\n  Table,\n  Space,\n  message,\n  Select,\n} from 'antd';\nimport Search from 'antd/es/input/Search';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport {\n  createTeacher,\n  deleteTeacher,\n  listClasses,\n  listSubjects,\n  listTeachers,\n  updateTeacher,\n} from '../../api/admin';\n\nexport default function Teachers() {\n  const [data, setData] = useState<any[]>([]);\n  const [search, setSearch] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [editing, setEditing] = useState<any | null>(null);\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const [subjectOptions, setSubjectOptions] = useState<\n    { label: string; value: string }[]\n  >([]);\n  const [classOptions, setClassOptions] = useState<\n    { label: string; value: string }[]\n  >([]);\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await listTeachers();\n      setData(res.teachers || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load teachers');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Load selectable options for subjects and classes\n  useEffect(() => {\n    (async () => {\n      try {\n        const [s, c] = await Promise.all([listSubjects(), listClasses()]);\n        const sOpts = (s.subjects || []).map((it: any) => ({\n          label: `${it.name} (${it.subjectCode || it.code})`,\n          value: it.subjectCode || it.code,\n        }));\n        const cOpts = (c.classes || []).map((it: any) => ({\n          label: `${it.name} (${it.classCode || it.code})`,\n          value: it.classCode || it.code,\n        }));\n        setSubjectOptions(sOpts);\n        setClassOptions(cOpts);\n      } catch (e: any) {\n        // Non-blocking\n      }\n    })();\n  }, []);\n\n  const onCreate = () => {\n    setEditing(null);\n    form.resetFields();\n    setModalOpen(true);\n  };\n  const onEdit = (record: any) => {\n    setEditing(record);\n    form.setFieldsValue({\n      username: record.user?.username || record.username,\n      email: record.user?.email || record.email,\n      teacherID: record.teacherID,\n      name: record.name,\n      subjectCodes: (record.subjects || [])\n        .map((s: any) => s?.subjectCode || s?.code)\n        .filter(Boolean),\n      classCodes: (record.assignedClasses || [])\n        .map((c: any) => c?.classCode || c?.code)\n        .filter(Boolean),\n    });\n    setModalOpen(true);\n  };\n  const onDelete = async (record: any) => {\n    try {\n      await deleteTeacher(record._id);\n      message.success('Deleted');\n      fetchData();\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Delete failed');\n    }\n  };\n\n  const onSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      const subjectCodesArr: string[] = Array.isArray(values.subjectCodes)\n        ? values.subjectCodes\n        : [];\n      const classCodesArr: string[] = Array.isArray(values.classCodes)\n        ? values.classCodes\n        : [];\n\n      const createPayload = {\n        username: values.username,\n        email: values.email,\n        password: values.password || 'Password@123',\n        teacherID: values.teacherID,\n        name: values.name,\n        subjects: subjectCodesArr,\n        assignedClasses: classCodesArr,\n      };\n\n      const updatePayload: any = {\n        username: values.username,\n        email: values.email,\n        teacherID: values.teacherID,\n        name: values.name,\n        // Preferred keys for edit per backend service\n        subjectCodes: subjectCodesArr,\n        classCodes: classCodesArr,\n        // Also include legacy keys for compatibility\n        subjects: subjectCodesArr,\n        assignedClasses: classCodesArr,\n      };\n      if (values.password) updatePayload.password = values.password;\n\n      if (editing) {\n        await updateTeacher(editing._id, updatePayload);\n        message.success('Updated');\n      } else {\n        await createTeacher(createPayload);\n        message.success('Created');\n      }\n      setModalOpen(false);\n      fetchData();\n    } catch (e: any) {\n      if (e?.errorFields) return;\n      message.error(e?.response?.data?.message || 'Save failed');\n    }\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <BackButton />\n      <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n        <h3>Teachers</h3>\n        <Button type=\"primary\" onClick={onCreate}>\n          Add Teacher\n        </Button>\n      </Space>\n      <Search\n        placeholder=\"Search by name, teacher ID, or email\"\n        allowClear\n        onChange={(e) => setSearch(e.target.value)}\n        style={{ maxWidth: 420 }}\n      />\n      <Table\n        rowKey=\"_id\"\n        loading={loading}\n        dataSource={\n          search\n            ? data.filter((t) => {\n                const name = (t.name || '').toLowerCase();\n                const tid = (t.teacherID || '').toLowerCase();\n                const email = (t.user?.email || t.email || '').toLowerCase();\n                const q = search.toLowerCase();\n                return name.includes(q) || tid.includes(q) || email.includes(q);\n              })\n            : data\n        }\n        scroll={{ x: true }}\n        columns={[\n          { title: 'Name', dataIndex: 'name' },\n          { title: 'Teacher ID', dataIndex: 'teacherID' },\n          {\n            title: 'Email',\n            dataIndex: ['user', 'email'],\n            render: (_: any, r: any) => r.user?.email || r.email,\n          },\n          {\n            title: 'Actions',\n            render: (_: any, record: any) => (\n              <Space>\n                <Button onClick={() => onEdit(record)}>Edit</Button>\n                <Button danger onClick={() => onDelete(record)}>\n                  Delete\n                </Button>\n              </Space>\n            ),\n          },\n        ]}\n      />\n\n      <Modal\n        title={editing ? 'Edit Teacher' : 'Create Teacher'}\n        open={modalOpen}\n        onOk={onSubmit}\n        onCancel={() => setModalOpen(false)}\n        destroyOnClose\n      >\n        <Form\n          form={form}\n          layout=\"vertical\"\n          onValuesChange={(changed) => {\n            if (changed.teacherID !== undefined) {\n              const tid = changed.teacherID;\n              const current = form.getFieldValue('username');\n              if (!current || current === form.__lastAutoUsername) {\n                form.setFieldsValue({ username: tid });\n                // @ts-ignore\n                form.__lastAutoUsername = tid;\n              }\n            }\n          }}\n        >\n          <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"teacherID\"\n            label=\"Teacher ID\"\n            rules={[{ required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"username\"\n            label=\"Username\"\n            rules={[\n              { required: true },\n              ({ getFieldValue }) => ({\n                validator(_, value) {\n                  const tid = getFieldValue('teacherID');\n                  if (!tid || !value || tid === value) return Promise.resolve();\n                  return Promise.reject(\n                    new Error('Username must match Teacher ID')\n                  );\n                },\n              }),\n            ]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"email\"\n            label=\"Email\"\n            rules={[{ type: 'email', required: true }]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item\n            name=\"password\"\n            label=\"Password\"\n            tooltip={\n              editing ? 'Leave blank to keep current password' : undefined\n            }\n          >\n            <Input.Password />\n          </Form.Item>\n          <Form.Item name=\"subjectCodes\" label=\"Subjects\">\n            <Select\n              mode=\"multiple\"\n              options={subjectOptions}\n              placeholder=\"Select subjects\"\n              showSearch\n              optionFilterProp=\"label\"\n            />\n          </Form.Item>\n          <Form.Item name=\"classCodes\" label=\"Assigned Classes\">\n            <Select\n              mode=\"multiple\"\n              options={classOptions}\n              placeholder=\"Select classes\"\n              showSearch\n              optionFilterProp=\"label\"\n            />\n          </Form.Item>\n        </Form>\n      </Modal>\n    </Space>\n  );\n}\n","size_bytes":8773},"src/pages/teacher/Summary.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Select, Button, Table, message, Space } from 'antd';\nimport { getMyClasses, getMySubjects, getSummary } from '../../api/teacher';\n\nexport default function Summary() {\n  const [classes, setClasses] = useState<any[]>([]);\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [classId, setClassId] = useState<string | null>(null);\n  const [subjectId, setSubjectId] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [summary, setSummary] = useState<any[]>([]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const [c, s] = await Promise.all([getMyClasses(), getMySubjects()]);\n        setClasses(c.classes || []);\n        setSubjects(s.subjects || []);\n      } catch (e) {}\n    })();\n  }, []);\n\n  const onFetch = async () => {\n    if (!classId || !subjectId) {\n      message.error('Select class and subject');\n      return;\n    }\n    setLoading(true);\n    try {\n      const res = await getSummary({ classId, subjectId });\n      setSummary(res.summary || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || e?.message || 'Fetch failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const columns = [\n    { title: 'Name', dataIndex: 'name' },\n    { title: 'Roll No', dataIndex: 'rollNo' },\n    { title: 'Present', dataIndex: 'present' },\n    { title: 'Absent', dataIndex: 'absent' },\n    { title: 'Total Classes', dataIndex: 'totalClasses' },\n    { title: 'Present %', dataIndex: 'presentPercentage' },\n  ];\n\n  return (\n    <div>\n      <h3>Attendance Summary</h3>\n      <div style={{ marginBottom: 12 }}>\n        <Select\n          placeholder=\"Class\"\n          style={{ minWidth: 200, marginRight: 8 }}\n          options={(classes || []).map((c) => ({\n            label: c.name,\n            value: c._id,\n          }))}\n          value={classId || undefined}\n          onChange={(v) => setClassId(v)}\n        />\n        <Select\n          placeholder=\"Subject\"\n          style={{ minWidth: 200, marginRight: 8 }}\n          options={(subjects || []).map((s) => ({\n            label: s.name,\n            value: s._id,\n          }))}\n          value={subjectId || undefined}\n          onChange={(v) => setSubjectId(v)}\n        />\n        <Button type=\"primary\" onClick={onFetch} loading={loading}>\n          Fetch\n        </Button>\n      </div>\n      <Table rowKey=\"_id\" dataSource={summary} columns={columns} />\n    </div>\n  );\n}\n","size_bytes":2475},"src/pages/Login.tsx":{"content":"import { useEffect, useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { Button, Card, Form, Input, Typography, Alert } from 'antd';\nimport { http } from '../api/http';\nimport { useAuth } from '../auth/AuthContext';\n\nexport default function Login() {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { setUser } = useAuth();\n\n  const desiredRole = useMemo(() => {\n    const p = new URLSearchParams(location.search);\n    return p.get('role') || undefined;\n  }, [location.search]);\n\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState<string | null>(null);\n\n  useEffect(() => {\n    setErr(null);\n  }, [desiredRole]);\n\n  const onFinish = async (values: { identifier: string; password: string }) => {\n    setLoading(true);\n    setErr(null);\n    try {\n      const { data } = await http.post('/auth/login', values);\n      const token = data?.token;\n      const role = data?.role;\n      if (!token || !role) throw new Error('Invalid login response.');\n\n      localStorage.setItem('token', token);\n      if (navigator.serviceWorker?.controller) {\n        navigator.serviceWorker.controller.postMessage({ type: 'SET_AUTH_TOKEN', token });\n      }\n      setUser({ token, role, ...data });\n\n      if (desiredRole && desiredRole !== role) {\n        setErr(`Your account role is ${role}. Please use the ${role} portal.`);\n        return;\n      }\n      if (role === 'Admin') navigate('/admin', { replace: true });\n      else if (role === 'Teacher') navigate('/teacher', { replace: true });\n      else if (role === 'Student') navigate('/student', { replace: true });\n      else navigate('/', { replace: true });\n    } catch (e: any) {\n      setErr(e?.response?.data?.error || e?.message || 'Login failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ minHeight: '100vh', display: 'grid', placeItems: 'center', padding: 24 }}>\n      <Card style={{ maxWidth: 420, width: '100%' }}>\n        <Typography.Title level={3} style={{ textAlign: 'center', marginBottom: 8 }}>\n          {desiredRole ? `${desiredRole} Login` : 'Login'}\n        </Typography.Title>\n        <Typography.Paragraph type=\"secondary\" style={{ textAlign: 'center', marginBottom: 16 }}>\n          Use your email/username and password\n        </Typography.Paragraph>\n        {err && <Alert type=\"error\" message={err} style={{ marginBottom: 16 }} />}\n        <Form layout=\"vertical\" onFinish={onFinish}>\n          <Form.Item\n            label=\"Identifier\"\n            name=\"identifier\"\n            rules={[{ required: true, message: 'Please enter email or username' }]}\n          >\n            <Input placeholder=\"Email or username\" />\n          </Form.Item>\n          <Form.Item\n            label=\"Password\"\n            name=\"password\"\n            rules={[{ required: true, message: 'Please enter password' }]}\n          >\n            <Input.Password placeholder=\"Password\" />\n          </Form.Item>\n          <Button type=\"primary\" htmlType=\"submit\" block loading={loading}>\n            Sign In\n          </Button>\n        </Form>\n        <Button style={{ marginTop: 12 }} block onClick={() => navigate('/')}>\n          â† Go to Home\n        </Button>\n      </Card>\n    </div>\n  );\n}\n\n\n","size_bytes":3282},"src/pages/student/StudentDashboard.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Card,\n  Col,\n  Row,\n  Typography,\n  Space,\n  Statistic,\n  Progress,\n  Divider,\n  Spin,\n  Alert,\n} from 'antd';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport {\n  getStudentProfile,\n  getMyClass,\n  getMyAttendanceSummary,\n  getMyAttendanceRecords,\n} from '../../api/student';\n\ntype SummaryRow = {\n  _id?: string;\n  name?: string;\n  subject?: string;\n  subjectCode?: string;\n  presentCount?: number;\n  present?: number;\n  absentCount?: number;\n  absent?: number;\n  totalClasses: number;\n  attendancePercentage: number | string;\n  presentPercentage?: number | string;\n};\n\nexport default function StudentDashboard() {\n  const navigate = useNavigate();\n  const [profile, setProfile] = useState<any | null>(null);\n  const [classInfo, setClassInfo] = useState<any | null>(null);\n  const [records, setRecords] = useState<any[]>([]);\n  const [summary, setSummary] = useState<SummaryRow[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n  const [filterLevel, setFilterLevel] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        // Fetch profile, summary and full records so totals reflect actual records\n        const [prof, summ, recs] = await Promise.all([\n          getStudentProfile(),\n          getMyAttendanceSummary(),\n          getMyAttendanceRecords({ subjectId: '', date: '' }),\n        ]);\n\n        const profileData = prof.profile || prof;\n        setProfile(profileData);\n        setClassInfo(profileData?.class || null);\n        setSummary(summ.summary || []);\n\n        const allRecords = recs.records || [];\n        setRecords(allRecords);\n\n        setErr(null);\n      } catch (e: any) {\n        setErr(\n          e?.response?.data?.message || e?.message || 'Failed to load dashboard'\n        );\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  // Filter and sort summary data\n  const processedSummary = summary\n    .filter((s) => {\n      if (!filterLevel) return true;\n      const pct = Number(s.attendancePercentage) || 0;\n      if (filterLevel === 'high') return pct >= 75;\n      if (filterLevel === 'med') return pct >= 50 && pct < 75;\n      if (filterLevel === 'low') return pct < 50;\n      return true;\n    })\n    .sort((a, b) => {\n      const pctA = Number(a.attendancePercentage) || 0;\n      const pctB = Number(b.attendancePercentage) || 0;\n      return sortOrder === 'asc' ? pctA - pctB : pctB - pctA;\n    });\n\n  if (loading) return <Spin />;\n  if (err)\n    return <Alert type=\"error\" message={err} style={{ marginBottom: 16 }} />;\n\n  // Calculate overall stats from actual attendance records (more reliable)\n  const totalClasses = records.length;\n  const totalPresent = records.filter((r) => r.status === 'Present').length;\n  const totalAbsent = totalClasses - totalPresent;\n  const overallAvg =\n    totalClasses > 0 ? Math.round((totalPresent / totalClasses) * 100) : 0;\n\n  return (\n    <div>\n      <BackButton />\n      <Typography.Title level={3}>Student Dashboard</Typography.Title>\n\n      {/* PROFILE & STATS SECTION */}\n      <Row gutter={[16, 16]} style={{ marginBottom: 24 }}>\n        {/* Profile Card */}\n        <Col xs={24} md={8}>\n          <Card style={{ textAlign: 'center' }}>\n            <Typography.Title level={4} style={{ margin: '8px 0' }}>\n              {profile?.name || 'Student'}\n            </Typography.Title>\n            <Typography.Text\n              type=\"secondary\"\n              style={{ display: 'block', marginBottom: 4 }}\n            >\n              {profile?.email}\n            </Typography.Text>\n            <Typography.Text\n              type=\"secondary\"\n              style={{ display: 'block', marginBottom: 8 }}\n            >\n              Roll No: {profile?.rollNo}\n            </Typography.Text>\n            <Divider />\n            <Typography.Text\n              type=\"secondary\"\n              style={{ display: 'block', marginBottom: 4 }}\n            >\n              Class: {classInfo?.name || 'N/A'}\n            </Typography.Text>\n          </Card>\n        </Col>\n\n        {/* Overall Stats */}\n        <Col xs={24} md={16}>\n          <Card>\n            <Row gutter={[16, 16]}>\n              <Col xs={24} sm={12}>\n                <Card\n                  style={{\n                    background:\n                      'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n                    color: '#fff',\n                  }}\n                >\n                  <Statistic\n                    title={<span style={{ color: '#fff' }}>Total Classes</span>}\n                    value={totalClasses}\n                    valueStyle={{ color: '#fff' }}\n                  />\n                </Card>\n              </Col>\n              <Col xs={24} sm={12}>\n                <Card\n                  style={{\n                    background:\n                      'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',\n                    color: '#fff',\n                  }}\n                >\n                  <Statistic\n                    title={\n                      <span style={{ color: '#fff' }}>Overall Attendance</span>\n                    }\n                    value={overallAvg}\n                    suffix=\"%\"\n                    valueStyle={{ color: '#fff' }}\n                  />\n                </Card>\n              </Col>\n              <Col xs={24} sm={12}>\n                <Card\n                  style={{\n                    background:\n                      'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',\n                    color: '#fff',\n                  }}\n                >\n                  <Statistic\n                    title={<span style={{ color: '#fff' }}>Present</span>}\n                    value={totalPresent}\n                    valueStyle={{ color: '#fff' }}\n                  />\n                </Card>\n              </Col>\n              <Col xs={24} sm={12}>\n                <Card\n                  style={{\n                    background:\n                      'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',\n                    color: '#fff',\n                  }}\n                >\n                  <Statistic\n                    title={<span style={{ color: '#fff' }}>Absent</span>}\n                    value={totalAbsent}\n                    valueStyle={{ color: '#fff' }}\n                  />\n                </Card>\n              </Col>\n            </Row>\n          </Card>\n        </Col>\n      </Row>\n\n      {/* ATTENDANCE BY SUBJECT */}\n      <Card style={{ marginBottom: 16 }}>\n        <Space direction=\"vertical\" style={{ width: '100%' }}>\n          <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n            <Typography.Title level={4} style={{ margin: 0 }}>\n              Attendance by Subject\n            </Typography.Title>\n            <Space>\n              <select\n                style={{\n                  padding: '4px 8px',\n                  borderRadius: '4px',\n                  border: '1px solid var(--border)',\n                  backgroundColor: 'var(--card)',\n                  color: 'var(--text)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                }}\n                value={sortOrder}\n                onChange={(e) => setSortOrder(e.target.value as 'asc' | 'desc')}\n              >\n                <option value=\"desc\">Highest First</option>\n                <option value=\"asc\">Lowest First</option>\n              </select>\n              <select\n                style={{\n                  padding: '4px 8px',\n                  borderRadius: '4px',\n                  border: '1px solid var(--border)',\n                  backgroundColor: 'var(--card)',\n                  color: 'var(--text)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                }}\n                value={filterLevel || ''}\n                onChange={(e) => setFilterLevel(e.target.value || null)}\n              >\n                <option value=\"\">All</option>\n                <option value=\"high\">High (â‰¥75%)</option>\n                <option value=\"med\">Medium (50-74%)</option>\n                <option value=\"low\">Low (&lt;50%)</option>\n              </select>\n            </Space>\n          </Space>\n\n          <Divider />\n\n          {processedSummary.length === 0 ? (\n            <Typography.Text type=\"secondary\">\n              No subject data available\n            </Typography.Text>\n          ) : (\n            <div style={{ display: 'grid', gap: 12 }}>\n              {processedSummary.map((s, idx) => {\n                const pct =\n                  Number(s.attendancePercentage || s.presentPercentage) || 0;\n                const color =\n                  pct >= 75 ? '#16a34a' : pct >= 50 ? '#f59e0b' : '#ef4444';\n                return (\n                  <Card key={idx} style={{ padding: 12 }}>\n                    <div\n                      style={{ display: 'flex', alignItems: 'center', gap: 12 }}\n                    >\n                      <div\n                        style={{ width: 200, fontSize: 14, fontWeight: 700 }}\n                      >\n                        {s.name || s.subject}\n                      </div>\n\n                      <div\n                        style={{\n                          flex: 1,\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 12,\n                        }}\n                      >\n                        <div style={{ flex: 1 }}>\n                          <Progress\n                            percent={Math.round(pct)}\n                            showInfo={false}\n                            strokeColor={color}\n                            strokeWidth={8}\n                            trailColor={'rgba(0,0,0,0.06)'}\n                          />\n                        </div>\n\n                        <div\n                          style={{\n                            minWidth: 56,\n                            textAlign: 'center',\n                            padding: '6px 8px',\n                            borderRadius: 999,\n                            background: color,\n                            color: '#fff',\n                            fontWeight: 700,\n                            boxShadow: '0 6px 18px rgba(2,6,23,0.06)',\n                          }}\n                        >\n                          {Math.round(pct)}%\n                        </div>\n                      </div>\n\n                      <div\n                        style={{\n                          width: 140,\n                          textAlign: 'right',\n                          fontSize: 13,\n                          color: 'var(--muted)',\n                        }}\n                      >\n                        {s.present || s.presentCount || 0} present â€¢{' '}\n                        {s.totalClasses || 0}\n                      </div>\n                    </div>\n                  </Card>\n                );\n              })}\n            </div>\n          )}\n        </Space>\n      </Card>\n\n      {/* QUICK ACTION CARDS */}\n      <Row gutter={[16, 16]}>\n        <Col xs={24} sm={12} md={8} lg={6}>\n          <Card\n            hoverable\n            onClick={() => navigate('/student/records')}\n            style={{\n              background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n              color: '#fff',\n              textAlign: 'center',\n            }}\n          >\n            <Typography.Title level={5} style={{ color: '#fff', margin: 0 }}>\n              ðŸ“‹ View All Records\n            </Typography.Title>\n          </Card>\n        </Col>\n      </Row>\n    </div>\n  );\n}\n","size_bytes":11827},"src/api/student.ts":{"content":"import { http } from './http';\n\nexport async function getStudentProfile() {\n  const { data } = await http.get('/student/me');\n  return data as any;\n}\n\nexport async function getMyClass() {\n  const { data } = await http.get('/student/my-class');\n  return data as any;\n}\n\nexport async function getMySubjects() {\n  const { data } = await http.get('/student/my-subjects');\n  return data as { count: number; subjects: any[] };\n}\n\nexport async function getMyAttendanceRecords(params: {\n  subjectId: string;\n  date: string;\n}) {\n  const { data } = await http.get('/student/my-attendance-records', { params });\n  return data as any;\n}\n\nexport async function getMyAttendanceSummary() {\n  const { data } = await http.get('/student/my-summary');\n  return data as { count: number; summary: any[] };\n}\n","size_bytes":788},"src/main.tsx":{"content":"import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\nimport { ThemeProvider } from './theme/ThemeProvider';\nimport { AuthProvider } from './auth/AuthContext';\nimport { LoadingProvider } from './context/LoadingContext';\nimport 'antd/dist/reset.css';\nimport './styles/global.css';\n\nif ('serviceWorker' in navigator) {\n  window.addEventListener('load', () => {\n    navigator.serviceWorker.register('/sw.js').catch((err) => {\n      console.error('SW registration failed:', err);\n    });\n  });\n}\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <ThemeProvider>\n        <LoadingProvider>\n          <AuthProvider>\n            <App />\n          </AuthProvider>\n        </LoadingProvider>\n      </ThemeProvider>\n    </BrowserRouter>\n  </React.StrictMode>\n);\n","size_bytes":900},"src/api/http.ts":{"content":"import axios from 'axios';\n\nexport const http = axios.create({\n  baseURL: import.meta.env.VITE_API_BASE || '/api',\n});\n\nhttp.interceptors.request.use((config) => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers = config.headers || {};\n    (config.headers as any).Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\nhttp.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      localStorage.removeItem('token');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n","size_bytes":599},"src/theme/ThemeProvider.tsx":{"content":"import { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { ConfigProvider, theme as antdTheme, ThemeConfig } from 'antd';\n\ntype ThemeMode = 'light' | 'dark';\n\ntype ThemeCtx = {\n  mode: ThemeMode;\n  setMode: (m: ThemeMode) => void;\n  toggle: () => void;\n};\n\nconst ThemeContext = createContext<ThemeCtx>({\n  mode: 'light',\n  setMode: () => {},\n  toggle: () => {},\n});\nexport const useThemeMode = () => useContext(ThemeContext);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const systemPrefersDark =\n    typeof window !== 'undefined' &&\n    window.matchMedia &&\n    window.matchMedia('(prefers-color-scheme: dark)').matches;\n  const [mode, setMode] = useState<ThemeMode>(\n    () =>\n      (localStorage.getItem('theme') as ThemeMode) ||\n      (systemPrefersDark ? 'dark' : 'light')\n  );\n\n  useEffect(() => {\n    localStorage.setItem('theme', mode);\n  }, [mode]);\n\n  // Keep a data attribute on <html> so CSS can react to theme changes.\n  useEffect(() => {\n    try {\n      document.documentElement.setAttribute('data-theme', mode);\n    } catch (e) {}\n  }, [mode]);\n\n  const algorithms = useMemo(\n    () =>\n      mode === 'dark'\n        ? [antdTheme.darkAlgorithm]\n        : [antdTheme.defaultAlgorithm],\n    [mode]\n  );\n\n  const config: ThemeConfig = useMemo(() => {\n    const lightTokens = {\n      colorPrimary: '#2563eb',\n      borderRadius: 10,\n      colorBgBase: '#f6f8fb',\n      colorText: '#0f172a',\n      colorBgContainer: '#ffffff',\n      colorBorder: '#e6eef6',\n      colorTextSecondary: '#6b7280',\n      boxShadow: '0 6px 18px rgba(16, 24, 40, 0.06)',\n    } as any;\n\n    const darkTokens = {\n      colorPrimary: '#2563eb',\n      borderRadius: 10,\n      colorBgBase: '#071427',\n      colorText: '#e6eef8',\n      colorBgContainer: '#0b1724',\n      colorBorder: '#15232f',\n      colorTextSecondary: '#94a3b8',\n      boxShadow: 'none',\n    } as any;\n\n    return {\n      algorithm: algorithms,\n      token: mode === 'dark' ? darkTokens : lightTokens,\n    };\n  }, [algorithms, mode]);\n\n  const value = useMemo(\n    () => ({\n      mode,\n      setMode,\n      toggle: () => setMode((m) => (m === 'dark' ? 'light' : 'dark')),\n    }),\n    [mode]\n  );\n\n  return (\n    <ThemeContext.Provider value={value}>\n      <ConfigProvider theme={config}>{children}</ConfigProvider>\n    </ThemeContext.Provider>\n  );\n}\n","size_bytes":2366},"src/layouts/StudentLayout.tsx":{"content":"import { useState } from 'react';\nimport { Layout, Menu, Grid, Drawer, Button, theme } from 'antd';\nimport {\n  DashboardOutlined,\n  FileTextOutlined,\n  LogoutOutlined,\n  MenuOutlined,\n} from '@ant-design/icons';\nimport { Outlet, useLocation, useNavigate } from 'react-router-dom';\n\nconst { Header, Sider, Content } = Layout;\nconst { useBreakpoint } = Grid;\n\nexport default function StudentLayout() {\n  const screens = useBreakpoint();\n  const isMobile = !screens.md;\n  const { token } = theme.useToken();\n  const [collapsed, setCollapsed] = useState(false);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const selectedKey = (() => {\n    if (location.pathname.startsWith('/student/records')) return 'records';\n    return 'dashboard';\n  })();\n\n  const menu = (\n    <Menu\n      mode=\"inline\"\n      selectedKeys={[selectedKey]}\n      onClick={({ key }) => {\n        if (key === 'logout') {\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          if (navigator.serviceWorker?.controller) {\n            navigator.serviceWorker.controller.postMessage({\n              type: 'SET_AUTH_TOKEN',\n              token: null,\n            });\n          }\n          navigate('/login?role=Student', { replace: true });\n          return;\n        }\n        navigate(`/student${key === 'dashboard' ? '' : `/${key}`}`);\n        setDrawerOpen(false);\n      }}\n      items={[\n        { key: 'dashboard', icon: <DashboardOutlined />, label: 'Dashboard' },\n        { key: 'records', icon: <FileTextOutlined />, label: 'Records' },\n        { type: 'divider' as any },\n        { key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },\n      ]}\n    />\n  );\n\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      {!isMobile && (\n        <Sider\n          collapsible\n          collapsed={collapsed}\n          onCollapse={setCollapsed}\n          theme=\"light\"\n          style={{ background: token.colorBgContainer }}\n        >\n          {menu}\n        </Sider>\n      )}\n      <Layout>\n        <Header\n          style={{\n            padding: '0 16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: 12,\n            background: token.colorBgContainer,\n            position: 'sticky',\n            top: 0,\n            zIndex: 1000,\n            boxShadow: 'var(--box-shadow, 0 1px 4px rgba(0,0,0,0.06))',\n          }}\n        >\n          {isMobile && (\n            <>\n              <Button\n                type=\"text\"\n                icon={<MenuOutlined style={{ color: token.colorText }} />}\n                onClick={() => setDrawerOpen(true)}\n              />\n              <Drawer\n                open={drawerOpen}\n                onClose={() => setDrawerOpen(false)}\n                placement=\"left\"\n                bodyStyle={{ padding: 0 }}\n              >\n                {menu}\n              </Drawer>\n            </>\n          )}\n        </Header>\n        <Content style={{ margin: '12px 16px' }}>\n          <Outlet />\n        </Content>\n      </Layout>\n    </Layout>\n  );\n}\n","size_bytes":3112},"src/auth/AuthContext.tsx":{"content":"import { createContext, useContext, useEffect, useMemo, useState } from 'react';\n\ntype User = {\n  token: string;\n  role: 'Admin' | 'Teacher' | 'Student';\n  [k: string]: any;\n} | null;\n\ntype AuthCtx = {\n  user: User;\n  setUser: (u: User) => void;\n  logout: () => void;\n};\n\nconst AuthContext = createContext<AuthCtx>({\n  user: null,\n  setUser: () => {},\n  logout: () => {},\n});\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUserState] = useState<User>(() => {\n    const token = localStorage.getItem('token');\n    const role = localStorage.getItem('role') as\n      | 'Admin'\n      | 'Teacher'\n      | 'Student'\n      | null;\n    if (!token) return null;\n    return { token, role: role || 'Admin' } as any;\n  });\n\n  const setUser = (u: User) => {\n    setUserState(u);\n    const token = u?.token || null;\n    const role = u?.role || null;\n    if (token) localStorage.setItem('token', token);\n    else localStorage.removeItem('token');\n    if (role) localStorage.setItem('role', role);\n    else localStorage.removeItem('role');\n    if (navigator.serviceWorker?.controller) {\n      navigator.serviceWorker.controller.postMessage({\n        type: 'SET_AUTH_TOKEN',\n        token,\n      });\n    }\n  };\n\n  const logout = () => setUser(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (navigator.serviceWorker?.controller) {\n      navigator.serviceWorker.controller.postMessage({\n        type: 'SET_AUTH_TOKEN',\n        token,\n      });\n    }\n  }, []);\n\n  const value = useMemo(() => ({ user, setUser, logout }), [user]);\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport const useAuth = () => useContext(AuthContext);\n","size_bytes":1732},"public/sw.js":{"content":"self.addEventListener('install', (event) => {\n  self.skipWaiting();\n});\n\nself.addEventListener('activate', (event) => {\n  event.waitUntil(self.clients.claim());\n});\n\nlet authToken = null;\n\nself.addEventListener('message', (event) => {\n  const data = event.data || {};\n  if (data.type === 'SET_AUTH_TOKEN') {\n    authToken = data.token || null;\n  } else if (data.type === 'GET_AUTH_TOKEN') {\n    const port = event.ports && event.ports[0];\n    port && port.postMessage({ token: authToken });\n  }\n});\n\nself.addEventListener('fetch', (event) => {\n  const url = new URL(event.request.url);\n  if (!url.pathname.startsWith('/api/admin/stream/')) return;\n\n  event.respondWith((async () => {\n    try {\n      const headers = new Headers(event.request.headers);\n      if (authToken && !headers.has('Authorization')) {\n        headers.set('Authorization', `Bearer ${authToken}`);\n      }\n      const init = {\n        method: event.request.method,\n        headers,\n        mode: event.request.mode,\n        credentials: event.request.credentials,\n        cache: event.request.cache,\n        redirect: event.request.redirect,\n        referrer: event.request.referrer,\n        integrity: event.request.integrity\n      };\n      if (event.request.method !== 'GET' && event.request.method !== 'HEAD') {\n        init.body = await event.request.clone().blob();\n      }\n      const authorizedRequest = new Request(event.request.url, init);\n      return fetch(authorizedRequest);\n    } catch (_e) {\n      return fetch(event.request);\n    }\n  })());\n});\n\n\n","size_bytes":1534},"src/api/admin.ts":{"content":"import { http } from './http';\n\nexport async function getAdminMe() {\n  const { data } = await http.get('/admin/me');\n  return data;\n}\n\nexport async function getAdminStats() {\n  const { data } = await http.get('/admin/stats');\n  return data as { students: number; teachers: number; rooms: number };\n}\n\n// Teachers\nexport async function listTeachers() { const { data } = await http.get('/admin/teachers'); return data; }\nexport async function createTeacher(payload: any) { const { data } = await http.post('/admin/teachers', payload); return data; }\nexport async function updateTeacher(id: string, payload: any) { const { data } = await http.put(`/admin/teachers/${id}`, payload); return data; }\nexport async function deleteTeacher(id: string) { const { data } = await http.delete(`/admin/teachers/${id}`); return data; }\n\n// Rooms\nexport async function listRooms() { const { data } = await http.get('/admin/rooms'); return data; }\nexport async function createRoom(payload: any) { const { data } = await http.post('/admin/rooms', payload); return data; }\nexport async function updateRoom(id: string, payload: any) { const { data } = await http.put(`/admin/rooms/${id}`, payload); return data; }\nexport async function deleteRoom(id: string) { const { data } = await http.delete(`/admin/rooms/${id}`); return data; }\n\n// Subjects\nexport async function listSubjects() { const { data } = await http.get('/admin/subjects'); return data; }\nexport async function createSubject(payload: any) { const { data } = await http.post('/admin/subjects', payload); return data; }\nexport async function deleteSubject(id: string) { const { data } = await http.delete(`/admin/subjects/${id}`); return data; }\n\n// Classes (router uses /class)\nexport async function listClasses() { const { data } = await http.get('/admin/class'); return data; }\nexport async function createClass(payload: any) { const { data } = await http.post('/admin/class', payload); return data; }\nexport async function deleteClass(id: string) { const { data } = await http.delete(`/admin/class/${id}`); return data; }\n\n// Students\nexport async function listStudents(params?: { classCode?: string }) {\n  const { data } = await http.get('/admin/students', { params });\n  return data;\n}\nexport async function createStudent(formData: FormData) {\n  const { data } = await http.post('/admin/student', formData);\n  return data;\n}\nexport async function updateStudent(id: string, formData: FormData) {\n  const { data } = await http.put(`/admin/student/${id}`, formData);\n  return data;\n}\nexport async function deleteStudent(id: string) {\n  const { data } = await http.delete(`/admin/student/${id}`);\n  return data;\n}\n\nexport function roomStreamUrl(roomId: string) {\n  return `/api/admin/stream/${encodeURIComponent(roomId)}`;\n}\n\n\n","size_bytes":2770},"src/pages/teacher/MySubjects.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Card, Col, Row, Spin, message, Button } from 'antd';\nimport { getMySubjects } from '../../api/teacher';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\n\nexport default function MySubjects() {\n  const [data, setData] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const fetchData = async () => {\n    setLoading(true);\n    try {\n      const res = await getMySubjects();\n      setData(res.subjects || []);\n    } catch (e: any) {\n      message.error(e?.response?.data?.message || 'Failed to load subjects');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  if (loading) return <Spin />;\n\n  return (\n    <div>\n      <BackButton />\n      <h3>My Subjects</h3>\n      <Row gutter={[16, 16]}>\n        {data.map((s) => (\n          <Col xs={24} sm={12} md={8} lg={6} key={s._id}>\n            <Card hoverable>\n              <div style={{ fontWeight: 600 }}>{s.name}</div>\n              <div style={{ color: '#666' }}>{s.subjectCode}</div>\n              <div style={{ color: '#999', marginTop: 8 }}>\n                {s.class?.name || ''}\n              </div>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </div>\n  );\n}\n","size_bytes":1349},"src/pages/Landing.tsx":{"content":"import { Link } from 'react-router-dom';\nimport { Button, Card, Space, Typography } from 'antd';\nimport {\n  RobotOutlined,\n  CloudOutlined,\n  ClusterOutlined,\n  CrownOutlined,\n  SolutionOutlined,\n  UserOutlined,\n} from '@ant-design/icons';\n\nexport default function Landing() {\n  return (\n    <div\n      style={{\n        minHeight: '100vh',\n        position: 'relative',\n        overflow: 'hidden',\n        display: 'grid',\n        placeItems: 'center',\n        padding: 24,\n        background:\n          'radial-gradient(1200px 600px at 10% 10%, rgba(99,102,241,0.18), transparent), radial-gradient(900px 500px at 90% 20%, rgba(139,92,246,0.16), transparent), radial-gradient(800px 500px at 30% 90%, rgba(20,184,166,0.14), transparent)',\n      }}\n    >\n      {/* Floating AI-themed icons */}\n      <div style={{ position: 'absolute', inset: 0, pointerEvents: 'none' }}>\n        <div\n          style={{\n            position: 'absolute',\n            top: '12%',\n            left: '10%',\n            animation: 'float 8s ease-in-out infinite',\n          }}\n        >\n          <RobotOutlined\n            style={{ fontSize: 56, color: 'rgba(99,102,241,0.65)' }}\n          />\n        </div>\n        <div\n          style={{\n            position: 'absolute',\n            top: '28%',\n            right: '12%',\n            animation: 'float 9s ease-in-out -2s infinite',\n          }}\n        >\n          <CloudOutlined\n            style={{ fontSize: 52, color: 'rgba(139,92,246,0.6)' }}\n          />\n        </div>\n        <div\n          style={{\n            position: 'absolute',\n            bottom: '14%',\n            left: '18%',\n            animation: 'float 10s ease-in-out -4s infinite',\n          }}\n        >\n          <ClusterOutlined\n            style={{ fontSize: 60, color: 'rgba(20,184,166,0.6)' }}\n          />\n        </div>\n      </div>\n\n      {/* Keyframes for simple float */}\n      <style>\n        {`\n        @keyframes float {\n          0%, 100% { transform: translateY(0px); }\n          50%      { transform: translateY(-16px); }\n        }\n        .glow {\n          text-shadow: 0 2px 16px rgba(99,102,241,0.55);\n        }\n        `}\n      </style>\n\n      <Card\n        style={{\n          maxWidth: 720,\n          width: '100%',\n          textAlign: 'center',\n          backdropFilter: 'blur(6px)',\n          background: 'rgba(255,255,255,0.7)',\n          border: '1px solid rgba(99,102,241,0.15)',\n          boxShadow: '0 12px 45px rgba(0,0,0,0.08)',\n        }}\n      >\n        <Typography.Title\n          level={2}\n          className=\"glow\"\n          style={{ marginBottom: 8, letterSpacing: 0.4 }}\n        >\n          AI Attendance System\n        </Typography.Title>\n        <Typography.Paragraph\n          type=\"secondary\"\n          style={{ marginBottom: 24, fontSize: 16 }}\n        >\n          Face-powered attendance with modern analytics and real-time monitoring\n        </Typography.Paragraph>\n        <Space direction=\"vertical\" size=\"middle\" style={{ width: '100%' }}>\n          <Link to=\"/login?role=Admin\">\n            <Button\n              type=\"primary\"\n              block\n              style={{ height: 44 }}\n              icon={<CrownOutlined />}\n            >\n              Enter Admin Portal\n            </Button>\n          </Link>\n          <Link to=\"/login?role=Teacher\">\n            <Button block style={{ height: 44 }} icon={<SolutionOutlined />}>\n              Enter Teacher Portal\n            </Button>\n          </Link>\n          <Link to=\"/login?role=Student\">\n            <Button block style={{ height: 44 }} icon={<UserOutlined />}>\n              Enter Student Portal\n            </Button>\n          </Link>\n        </Space>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3700},"src/pages/admin/AdminDashboard.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Card, Col, Row, Typography, Spin, Alert, Button, theme } from 'antd';\nimport {\n  RobotOutlined,\n  TeamOutlined,\n  ApartmentOutlined,\n} from '@ant-design/icons';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport { getAdminStats } from '../../api/admin';\n\nexport default function AdminDashboard() {\n  const navigate = useNavigate();\n  const { token } = theme.useToken();\n  const [stats, setStats] = useState<any | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const data = await getAdminStats();\n        setStats(data);\n      } catch (e: any) {\n        setErr(\n          e?.response?.data?.message || e?.message || 'Failed to load stats'\n        );\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  if (loading) return <Spin />;\n  if (err) return <Alert type=\"error\" message={err} />;\n\n  const entries =\n    stats && typeof stats === 'object' ? Object.entries(stats) : [];\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        overflow: 'hidden',\n      }}\n    >\n      <style>\n        {`\n        @keyframes pulseGlow {\n          0%, 100% { box-shadow: 0 0 0 rgba(99,102,241,0.0); }\n          50% { box-shadow: 0 0 40px rgba(99,102,241,0.25); }\n        }\n        @keyframes float {\n          0%, 100% { transform: translateY(0px); }\n          50%      { transform: translateY(-10px); }\n        }\n        `}\n      </style>\n      <BackButton />\n      <Typography.Title level={3} style={{ letterSpacing: 0.4 }}>\n        Admin Dashboard\n      </Typography.Title>\n      <Row gutter={[16, 16]}>\n        {entries.map(([key, value]) => {\n          const lower = key.toLowerCase();\n          const Icon = lower.includes('teacher')\n            ? TeamOutlined\n            : lower.includes('room')\n            ? ApartmentOutlined\n            : RobotOutlined;\n          const bg = token.colorBgContainer;\n          const border = `1px solid ${token.colorBorderSecondary}`;\n          return (\n            <Col xs={24} sm={12} md={8} lg={6} key={key}>\n              <Card\n                style={{\n                  background: bg,\n                  border,\n                  transition: 'transform 200ms ease, box-shadow 200ms ease',\n                  animation: 'pulseGlow 3.5s ease-in-out infinite',\n                }}\n                onMouseEnter={(e) => {\n                  (e.currentTarget as HTMLDivElement).style.transform =\n                    'translateY(-4px)';\n                }}\n                onMouseLeave={(e) => {\n                  (e.currentTarget as HTMLDivElement).style.transform =\n                    'translateY(0px)';\n                }}\n              >\n                <div\n                  style={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 12,\n                    marginBottom: 4,\n                  }}\n                >\n                  <Icon\n                    style={{\n                      fontSize: 26,\n                      color: 'rgba(99,102,241,0.85)',\n                      animation: 'float 6s ease-in-out infinite',\n                    }}\n                  />\n                  <Typography.Text\n                    type=\"secondary\"\n                    style={{ textTransform: 'capitalize' }}\n                  >\n                    {key}\n                  </Typography.Text>\n                </div>\n                <Typography.Title level={2} style={{ margin: 0 }}>\n                  {String(value)}\n                </Typography.Title>\n              </Card>\n            </Col>\n          );\n        })}\n      </Row>\n    </div>\n  );\n}\n","size_bytes":3803},"src/layouts/TeacherLayout.tsx":{"content":"import { useState } from 'react';\nimport { Layout, Menu, Grid, Drawer, Button, theme } from 'antd';\nimport {\n  MenuOutlined,\n  DashboardOutlined,\n  TeamOutlined,\n  AppstoreOutlined,\n  BookOutlined,\n  VideoCameraOutlined,\n  LogoutOutlined,\n} from '@ant-design/icons';\nimport { Outlet, useLocation, useNavigate } from 'react-router-dom';\n\nconst { Header, Sider, Content } = Layout;\nconst { useBreakpoint } = Grid;\n\nexport default function TeacherLayout() {\n  const screens = useBreakpoint();\n  const isMobile = !screens.md;\n  const { token } = theme.useToken();\n  const [collapsed, setCollapsed] = useState(false);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const selectedKey = (() => {\n    if (location.pathname.startsWith('/teacher/my-classes'))\n      return 'my-classes';\n    if (location.pathname.startsWith('/teacher/my-subjects'))\n      return 'my-subjects';\n    if (location.pathname.startsWith('/teacher/mark-attendance')) return 'mark';\n    if (location.pathname.startsWith('/teacher/records')) return 'records';\n    if (location.pathname.startsWith('/teacher/summary')) return 'summary';\n    return 'dashboard';\n  })();\n\n  const menu = (\n    <Menu\n      mode=\"inline\"\n      selectedKeys={[selectedKey]}\n      onClick={({ key }) => {\n        if (key === 'logout') {\n          localStorage.removeItem('token');\n          navigate('/login?role=Teacher', { replace: true });\n          return;\n        }\n        const pathMap: Record<string, string> = {\n          dashboard: '/teacher',\n          'my-classes': '/teacher/my-classes',\n          'my-subjects': '/teacher/my-subjects',\n          mark: '/teacher/mark-attendance',\n          records: '/teacher/records',\n          summary: '/teacher/summary',\n        };\n        navigate(pathMap[key as string] || '/teacher');\n        setDrawerOpen(false);\n      }}\n      items={[\n        { key: 'dashboard', icon: <DashboardOutlined />, label: 'Dashboard' },\n        { key: 'my-classes', icon: <TeamOutlined />, label: 'My Classes' },\n        { key: 'my-subjects', icon: <BookOutlined />, label: 'My Subjects' },\n        {\n          key: 'mark',\n          icon: <VideoCameraOutlined />,\n          label: 'Mark Attendance',\n        },\n        { key: 'records', icon: <AppstoreOutlined />, label: 'Records' },\n        { key: 'summary', icon: <AppstoreOutlined />, label: 'Summary' },\n        { type: 'divider' as any },\n        { key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },\n      ]}\n    />\n  );\n\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      {!isMobile && (\n        <Sider\n          collapsible\n          collapsed={collapsed}\n          onCollapse={setCollapsed}\n          theme=\"light\"\n          style={{ background: token.colorBgContainer }}\n        >\n          {menu}\n        </Sider>\n      )}\n      <Layout>\n        <Header\n          style={{\n            padding: '0 16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: 12,\n            background: token.colorBgContainer,\n            position: 'sticky',\n            top: 0,\n            zIndex: 1000,\n            boxShadow: 'var(--box-shadow, 0 1px 4px rgba(0,0,0,0.06))',\n          }}\n        >\n          {isMobile && (\n            <>\n              <Button\n                type=\"text\"\n                icon={<MenuOutlined style={{ color: token.colorText }} />}\n                onClick={() => setDrawerOpen(true)}\n              />\n              <Drawer\n                open={drawerOpen}\n                onClose={() => setDrawerOpen(false)}\n                placement=\"left\"\n                bodyStyle={{ padding: 0 }}\n              >\n                {menu}\n              </Drawer>\n            </>\n          )}\n        </Header>\n        <Content style={{ margin: '12px 16px' }}>\n          <Outlet />\n        </Content>\n      </Layout>\n    </Layout>\n  );\n}\n","size_bytes":3900},"src/pages/teacher/TeacherDashboard.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Card,\n  Col,\n  Row,\n  Typography,\n  Select,\n  Space,\n  Statistic,\n  Progress,\n  Divider,\n  Empty,\n  Spin,\n  Alert,\n} from 'antd';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport { getMyClasses, getMySubjects, getSummary } from '../../api/teacher';\n\ntype SummaryRow = {\n  _id: string;\n  name: string;\n  rollNo: string | number;\n  present: number;\n  absent: number;\n  totalClasses: number;\n  presentPercentage: number;\n};\n\nexport default function TeacherDashboard() {\n  const navigate = useNavigate();\n  const [classes, setClasses] = useState<any[]>([]);\n  const [subjects, setSubjects] = useState<any[]>([]);\n  const [classId, setClassId] = useState<string | null>(null);\n  const [subjectId, setSubjectId] = useState<string | null>(null);\n  const [summary, setSummary] = useState<SummaryRow[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [initialLoading, setInitialLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n  const [dashboardSort, setDashboardSort] = useState<'asc' | 'desc'>('desc'); // desc = highest attendance first\n  const [dashboardFilter, setDashboardFilter] = useState<string | null>(null); // 'high' (>=75), 'med' (50-74), 'low' (<50)\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const [c, s] = await Promise.all([getMyClasses(), getMySubjects()]);\n        setClasses(c.classes || []);\n        setSubjects(s.subjects || []);\n        // default to first available\n        if ((c.classes || []).length > 0) setClassId(c.classes[0]._id);\n        if ((s.subjects || []).length > 0) setSubjectId(s.subjects[0]._id);\n        setErr(null);\n      } catch (e: any) {\n        setErr(\n          e?.response?.data?.message ||\n            e?.message ||\n            'Failed to load classes/subjects'\n        );\n      } finally {\n        setInitialLoading(false);\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    // fetch summary when class/subject selected\n    if (!classId || !subjectId) return;\n    (async () => {\n      setLoading(true);\n      try {\n        const res = await getSummary({ classId, subjectId });\n        setSummary(res.summary || []);\n      } catch (e) {\n        setSummary([]);\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [classId, subjectId]);\n\n  // Filter and sort dashboard summary data\n  const processedSummary = summary\n    .filter((s) => {\n      if (!dashboardFilter) return true;\n      const pct = Number(s.presentPercentage) || 0;\n      if (dashboardFilter === 'high') return pct >= 75;\n      if (dashboardFilter === 'med') return pct >= 50 && pct < 75;\n      if (dashboardFilter === 'low') return pct < 50;\n      return true;\n    })\n    .sort((a, b) => {\n      const pctA = Number(a.presentPercentage) || 0;\n      const pctB = Number(b.presentPercentage) || 0;\n      return dashboardSort === 'asc' ? pctA - pctB : pctB - pctA;\n    });\n\n  return (\n    <div>\n      <BackButton />\n      <Typography.Title level={3}>Teacher Dashboard</Typography.Title>\n\n      {initialLoading ? (\n        <Spin />\n      ) : err ? (\n        <Alert type=\"error\" message={err} style={{ marginBottom: 16 }} />\n      ) : (\n        <>\n          {/* SUMMARY PANEL - visual charts and colors on dashboard landing */}\n          <Card style={{ marginBottom: 16 }}>\n            <Space direction=\"vertical\" style={{ width: '100%' }}>\n              <Space style={{ justifyContent: 'space-between', width: '100%' }}>\n                <Space>\n                  <Select\n                    placeholder=\"Class\"\n                    style={{ minWidth: 200 }}\n                    options={(classes || []).map((c) => ({\n                      label: c.name,\n                      value: c._id,\n                    }))}\n                    value={classId || undefined}\n                    onChange={(v) => setClassId(v)}\n                  />\n                  <Select\n                    placeholder=\"Subject\"\n                    style={{ minWidth: 200 }}\n                    options={(subjects || []).map((s) => ({\n                      label: s.name,\n                      value: s._id,\n                    }))}\n                    value={subjectId || undefined}\n                    onChange={(v) => setSubjectId(v)}\n                  />\n                </Space>\n\n                <Space>\n                  <Statistic title=\"Students\" value={summary.length} />\n                </Space>\n              </Space>\n\n              <Divider />\n\n              {loading ? (\n                <div style={{ textAlign: 'center', padding: 20 }}>\n                  <Spin />\n                </div>\n              ) : summary.length === 0 ? (\n                <Empty description=\"No summary available for selected class/subject\" />\n              ) : (\n                <Row gutter={[16, 16]}>\n                  <Col xs={24} md={8}>\n                    {/* Overall average attendance */}\n                    <Card>\n                      <Typography.Text type=\"secondary\">\n                        Average Attendance\n                      </Typography.Text>\n                      <div\n                        style={{\n                          display: 'flex',\n                          alignItems: 'center',\n                          gap: 16,\n                          marginTop: 8,\n                        }}\n                      >\n                        {(() => {\n                          const sum = summary.reduce(\n                            (s, r) => s + (Number(r.presentPercentage) || 0),\n                            0\n                          );\n                          const avg = summary.length\n                            ? Math.round(sum / summary.length)\n                            : 0;\n                          return (\n                            <>\n                              <Progress\n                                type=\"circle\"\n                                percent={avg}\n                                width={120}\n                              />\n                              <div>\n                                <Statistic\n                                  title=\"Avg Present %\"\n                                  value={avg}\n                                  suffix=\"%\"\n                                />\n                              </div>\n                            </>\n                          );\n                        })()}\n                      </div>\n                    </Card>\n                  </Col>\n\n                  <Col xs={24} md={16}>\n                    {/* Per-student bars - colored */}\n                    <Card>\n                      <Space direction=\"vertical\" style={{ width: '100%' }}>\n                        <Space\n                          style={{\n                            justifyContent: 'space-between',\n                            width: '100%',\n                          }}\n                        >\n                          <Typography.Text type=\"secondary\">\n                            Students (Present %)\n                          </Typography.Text>\n                          <Space>\n                            <Select\n                              placeholder=\"Sort\"\n                              style={{ minWidth: 140 }}\n                              value={dashboardSort}\n                              onChange={(v) => setDashboardSort(v)}\n                              options={[\n                                { label: 'Highest First', value: 'desc' },\n                                { label: 'Lowest First', value: 'asc' },\n                              ]}\n                            />\n                            <Select\n                              placeholder=\"Filter\"\n                              style={{ minWidth: 140 }}\n                              allowClear\n                              value={dashboardFilter || undefined}\n                              onChange={(v) => setDashboardFilter(v)}\n                              options={[\n                                { label: 'All', value: null },\n                                { label: 'High (â‰¥75%)', value: 'high' },\n                                { label: 'Medium (50-74%)', value: 'med' },\n                                { label: 'Low (<50%)', value: 'low' },\n                              ]}\n                            />\n                          </Space>\n                        </Space>\n                        <div\n                          style={{ marginTop: 12, display: 'grid', gap: 12 }}\n                        >\n                          {processedSummary.map((s) => (\n                            <div\n                              key={s._id}\n                              style={{\n                                display: 'flex',\n                                alignItems: 'center',\n                                gap: 12,\n                              }}\n                            >\n                              <div style={{ width: 160, fontSize: 13 }}>\n                                {s.name} ({s.rollNo})\n                              </div>\n                              <div style={{ flex: 1 }}>\n                                <Progress\n                                  percent={Math.round(s.presentPercentage)}\n                                  showInfo={false}\n                                  strokeColor={\n                                    s.presentPercentage >= 75\n                                      ? '#22c55e'\n                                      : s.presentPercentage >= 50\n                                      ? '#f59e0b'\n                                      : '#ef4444'\n                                  }\n                                />\n                              </div>\n                              <div\n                                style={{\n                                  width: 60,\n                                  textAlign: 'right',\n                                  fontWeight: 600,\n                                }}\n                              >\n                                {Math.round(s.presentPercentage)}%\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </Space>\n                    </Card>\n                  </Col>\n                </Row>\n              )}\n            </Space>\n          </Card>\n\n          <Row gutter={[16, 16]}>\n            <Col xs={24} sm={12} md={8} lg={6}>\n              <Card hoverable onClick={() => navigate('/teacher/my-classes')}>\n                My Classes\n              </Card>\n            </Col>\n            <Col xs={24} sm={12} md={8} lg={6}>\n              <Card hoverable onClick={() => navigate('/teacher/my-subjects')}>\n                My Subjects\n              </Card>\n            </Col>\n            <Col xs={24} sm={12} md={8} lg={6}>\n              <Card\n                hoverable\n                onClick={() => navigate('/teacher/mark-attendance')}\n              >\n                Mark Attendance\n              </Card>\n            </Col>\n            <Col xs={24} sm={12} md={8} lg={6}>\n              <Card hoverable onClick={() => navigate('/teacher/records')}>\n                Records\n              </Card>\n            </Col>\n          </Row>\n        </>\n      )}\n    </div>\n  );\n}\n","size_bytes":11358},"src/context/LoadingContext.tsx":{"content":"import React, { createContext, useCallback, useContext, useState } from 'react';\nimport { Spin } from 'antd';\n\ntype LoadingCtx = {\n  show: () => void;\n  hide: () => void;\n  loading: boolean;\n};\n\nconst LoadingContext = createContext<LoadingCtx>({\n  show: () => {},\n  hide: () => {},\n  loading: false,\n});\n\nexport const useGlobalLoading = () => useContext(LoadingContext);\n\nexport const LoadingProvider = ({\n  children,\n}: {\n  children: React.ReactNode;\n}) => {\n  const [count, setCount] = useState(0);\n\n  const show = useCallback(() => setCount((c) => c + 1), []);\n  const hide = useCallback(() => setCount((c) => Math.max(0, c - 1)), []);\n\n  const value = { show, hide, loading: count > 0 };\n\n  return (\n    <LoadingContext.Provider value={value}>\n      {children}\n      {count > 0 && (\n        <div\n          style={{\n            position: 'fixed',\n            inset: 0,\n            zIndex: 9999,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            // use CSS variable so overlay adapts to theme\n            background: 'var(--overlay, rgba(0,0,0,0.35))',\n          }}\n        >\n          <Spin size=\"large\" tip=\"Loading...\" />\n        </div>\n      )}\n    </LoadingContext.Provider>\n  );\n};\n","size_bytes":1253},"src/components/NavBar.tsx":{"content":"import { Space, Tooltip, Button, Typography, theme } from 'antd';\nimport { useThemeMode } from '../theme/ThemeProvider';\nimport { SunOutlined, MoonOutlined } from '@ant-design/icons';\n\nexport default function NavBar() {\n  const { mode, setMode } = useThemeMode();\n  const { token } = theme.useToken();\n  return (\n    <Space align=\"center\">\n      <Tooltip title=\"Light\">\n        <Button\n          type={mode === 'light' ? 'primary' : 'text'}\n          icon={<SunOutlined />}\n          onClick={() => setMode('light')}\n        />\n      </Tooltip>\n      <Tooltip title=\"Dark\">\n        <Button\n          type={mode === 'dark' ? 'primary' : 'text'}\n          icon={<MoonOutlined />}\n          onClick={() => setMode('dark')}\n        />\n      </Tooltip>\n      <Typography.Text style={{ color: token.colorText, marginLeft: 8 }}>\n        Theme\n      </Typography.Text>\n    </Space>\n  );\n}\n","size_bytes":881},"src/App.tsx":{"content":"import { Layout, Typography, theme } from 'antd';\nimport AppRouter from './router/AppRouter';\nimport NavBar from './components/NavBar';\n\nexport default function App() {\n  const { token } = theme.useToken();\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      <Layout.Header\n        style={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          background: token.colorBgContainer,\n          position: 'sticky',\n          top: 0,\n          zIndex: 1100,\n          boxShadow: 'var(--box-shadow, 0 1px 4px rgba(0,0,0,0.06))',\n        }}\n      >\n        <Typography.Text style={{ color: token.colorText, fontWeight: 600 }}>\n          AI Attendance\n        </Typography.Text>\n        <NavBar />\n      </Layout.Header>\n      <Layout.Content style={{ padding: 16 }}>\n        <AppRouter />\n      </Layout.Content>\n    </Layout>\n  );\n}\n","size_bytes":894},"src/pages/admin/RoomStream.tsx":{"content":"import { useEffect, useMemo, useState } from 'react';\nimport {\n  Input,\n  Button,\n  Space,\n  Typography,\n  Alert,\n  Card,\n  Row,\n  Col,\n  message,\n} from 'antd';\nimport Search from 'antd/es/input/Search';\nimport { listRooms } from '../../api/admin';\nimport { roomStreamUrl } from '../../api/admin';\n\nexport default function RoomStream() {\n  const [roomId, setRoomId] = useState('');\n  const [submitted, setSubmitted] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [rooms, setRooms] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [search, setSearch] = useState('');\n  const [imgLoading, setImgLoading] = useState(false);\n\n  useEffect(() => {\n    (async () => {\n      setLoading(true);\n      try {\n        const res = await listRooms();\n        setRooms(res.rooms || []);\n      } catch (e: any) {\n        message.error(e?.response?.data?.message || 'Failed to load rooms');\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  const handleShow = () => {\n    if (!roomId.trim()) {\n      setError('Please enter a roomId');\n      setSubmitted(false);\n      return;\n    }\n    setError(null);\n    setSubmitted(true);\n    setImgLoading(true);\n    setRefreshKey((k) => k + 1);\n  };\n\n  const buildStreamUrl = (id: string) => {\n    const base = window.location.origin; // use same-origin backend proxy or server\n    const token = localStorage.getItem('token') || '';\n    const q = new URLSearchParams();\n    q.set('t', String(Date.now()));\n    if (token) q.set('token', token);\n    return `${base}${roomStreamUrl(id)}?${q.toString()}`;\n  };\n\n  return (\n    <Space direction=\"vertical\" style={{ width: '100%' }}>\n      <Typography.Title level={4}>Room Stream</Typography.Title>\n      <Search\n        placeholder=\"Search rooms by name, id, description, or camera id\"\n        allowClear\n        onChange={(e) => setSearch(e.target.value)}\n        style={{ maxWidth: 520 }}\n      />\n      <Row gutter={[16, 16]}>\n        {(search\n          ? rooms.filter((r: any) => {\n              const name = (r.name || '').toLowerCase();\n              const id = (r._id || '').toLowerCase();\n              const desc = (r.description || '').toLowerCase();\n              const camIds = (r.cameras || [])\n                .map((c: any) => c.cameraId || '')\n                .join(' ')\n                .toLowerCase();\n              const q = search.toLowerCase();\n              return (\n                name.includes(q) ||\n                id.includes(q) ||\n                desc.includes(q) ||\n                camIds.includes(q)\n              );\n            })\n          : rooms\n        ).map((r) => {\n          const firstCam = (r.cameras || [])[0];\n          return (\n            <Col xs={24} sm={12} md={8} lg={6} key={r._id}>\n              <Card\n                hoverable\n                onClick={() => {\n                  setRoomId(r._id);\n                  setError(null);\n                  setSubmitted(true);\n                  setImgLoading(true);\n                  setRefreshKey((k) => k + 1);\n                }}\n              >\n                <Typography.Title level={5} style={{ marginBottom: 4 }}>\n                  {r.name}\n                </Typography.Title>\n                <Typography.Text type=\"secondary\">\n                  Room ID: {r._id}\n                </Typography.Text>\n                <div style={{ marginTop: 6 }}>\n                  <Typography.Text type=\"secondary\">\n                    Camera ID: {firstCam?.cameraId || 'â€”'}\n                  </Typography.Text>\n                </div>\n                <div style={{ marginTop: 6 }}>\n                  <Typography.Text type=\"secondary\">\n                    Description: {r.description || 'â€”'}\n                  </Typography.Text>\n                </div>\n              </Card>\n            </Col>\n          );\n        })}\n      </Row>\n      {submitted && (\n        <Card title={`Live stream for room: ${roomId}`} bordered>\n          {imgLoading && !error && (\n            <Typography.Text type=\"secondary\">\n              Loading stream...\n            </Typography.Text>\n          )}\n          {error ? (\n            <Alert\n              type=\"error\"\n              message={error}\n              description=\"We couldnâ€™t fetch the live stream. Please verify the roomId, camera configuration, and your permissions.\"\n            />\n          ) : (\n            <img // <--- Revert back to this\n              key={refreshKey}\n              src={buildStreamUrl(roomId)}\n              alt=\"Room stream\"\n              style={{ maxWidth: '100%', border: '1px solid #eee' }}\n              onLoad={() => setImgLoading(false)}\n              onError={() => {\n                setImgLoading(false);\n                setError('Could not load stream (check roomId/permissions).');\n              }}\n            />\n          )}\n        </Card>\n      )}\n    </Space>\n  );\n}\n","size_bytes":4945},"src/styles/global.css":{"content":"/* Global modern styles with light/dark tokens */\n:root {\n  --bg: #f6f8fb;\n  --card: #ffffff;\n  --muted: #6b7280;\n  --primary: #2563eb; /* slightly deeper blue */\n  --radius: 10px;\n  --max-width: 1100px;\n  --text: #111827;\n  --overlay: rgba(0, 0, 0, 0.35);\n  --box-shadow: 0 6px 18px rgba(16, 24, 40, 0.06);\n  --border: #d9d9d9;\n}\n\n/* Dark theme overrides when HTML has data-theme=\"dark\" */\n[data-theme='dark'] {\n  --bg: #071427;\n  --card: #0b1724;\n  --muted: #94a3b8;\n  --primary: #2563eb;\n  --radius: 10px;\n  --max-width: 1100px;\n  --text: #e6eef8;\n  --overlay: rgba(0, 0, 0, 0.55);\n  --box-shadow: none;\n  --border: #434d62;\n}\nhtml,\nbody,\n#root {\n  height: 100%;\n}\nbody {\n  margin: 0;\n  font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI',\n    Roboto, 'Helvetica Neue', Arial;\n  background: linear-gradient(180deg, var(--bg) 0%, var(--card) 100%);\n  color: var(--text);\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n.ant-card {\n  border-radius: var(--radius) !important;\n  background: var(--card) !important;\n  box-shadow: var(--box-shadow);\n  transition: transform 180ms ease, box-shadow 180ms ease;\n}\n.ant-card:hover {\n  transform: translateY(-6px);\n  box-shadow: 0 12px 36px rgba(2, 6, 23, 0.12);\n}\n.ant-btn-primary {\n  background: var(--primary);\n  border-color: var(--primary);\n}\n.container {\n  max-width: var(--max-width);\n  margin: 0 auto;\n}\n.header-title {\n  font-weight: 700;\n  letter-spacing: -0.2px;\n}\n/* Make tables and selects more roomy */\n.ant-select-selector {\n  min-height: 44px !important;\n  border-radius: 8px !important;\n}\n.ant-table-thead > tr > th {\n  background: transparent;\n  color: var(--muted);\n  font-weight: 600;\n}\n\n/* Make header sticky visually separated from content when scrolling */\nheader[role='banner'] {\n  transition: box-shadow 200ms ease;\n}\n\n/* Subtle page content entrance */\n.page-enter {\n  opacity: 0;\n  transform: translateY(8px);\n}\n.page-enter-active {\n  opacity: 1;\n  transform: translateY(0);\n  transition: all 220ms ease;\n}\n","size_bytes":2027},"src/layouts/AdminLayout.tsx":{"content":"import { useState } from 'react';\nimport { Layout, Menu, Grid, Drawer, Button, theme } from 'antd';\nimport {\n  DashboardOutlined,\n  VideoCameraOutlined,\n  TeamOutlined,\n  AppstoreOutlined,\n  BookOutlined,\n  ApartmentOutlined,\n  LogoutOutlined,\n  MenuOutlined,\n} from '@ant-design/icons';\nimport { Outlet, useLocation, useNavigate } from 'react-router-dom';\n\nconst { Header, Sider, Content } = Layout;\nconst { useBreakpoint } = Grid;\n\nexport default function AdminLayout() {\n  const screens = useBreakpoint();\n  const isMobile = !screens.md;\n  const { token } = theme.useToken();\n  const [collapsed, setCollapsed] = useState(false);\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const selectedKey = (() => {\n    if (location.pathname.startsWith('/admin/stream')) return 'stream';\n    if (location.pathname.startsWith('/admin/teachers')) return 'teachers';\n    if (location.pathname.startsWith('/admin/rooms')) return 'rooms';\n    if (location.pathname.startsWith('/admin/subjects')) return 'subjects';\n    if (location.pathname.startsWith('/admin/classes')) return 'classes';\n    if (location.pathname.startsWith('/admin/students')) return 'students';\n    return 'dashboard';\n  })();\n\n  const menu = (\n    <Menu\n      mode=\"inline\"\n      selectedKeys={[selectedKey]}\n      onClick={({ key }) => {\n        if (key === 'logout') {\n          localStorage.removeItem('token');\n          if (navigator.serviceWorker?.controller) {\n            navigator.serviceWorker.controller.postMessage({\n              type: 'SET_AUTH_TOKEN',\n              token: null,\n            });\n          }\n          navigate('/login?role=Admin', { replace: true });\n          return;\n        }\n        navigate(`/admin${key === 'dashboard' ? '' : `/${key}`}`);\n        setDrawerOpen(false);\n      }}\n      items={[\n        { key: 'dashboard', icon: <DashboardOutlined />, label: 'Dashboard' },\n        { key: 'stream', icon: <VideoCameraOutlined />, label: 'Stream' },\n        { key: 'teachers', icon: <TeamOutlined />, label: 'Teachers' },\n        { key: 'subjects', icon: <BookOutlined />, label: 'Subjects' },\n        { key: 'rooms', icon: <ApartmentOutlined />, label: 'Rooms' },\n        { key: 'classes', icon: <AppstoreOutlined />, label: 'Classes' },\n        { key: 'students', icon: <TeamOutlined />, label: 'Students' },\n        { type: 'divider' as any },\n        { key: 'logout', icon: <LogoutOutlined />, label: 'Logout' },\n      ]}\n    />\n  );\n\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      {!isMobile && (\n        <Sider\n          collapsible\n          collapsed={collapsed}\n          onCollapse={setCollapsed}\n          theme=\"light\"\n          style={{ background: token.colorBgContainer }}\n        >\n          {menu}\n        </Sider>\n      )}\n      <Layout>\n        <Header\n          style={{\n            padding: '0 16px',\n            display: 'flex',\n            alignItems: 'center',\n            gap: 12,\n            background: token.colorBgContainer,\n            position: 'sticky',\n            top: 0,\n            zIndex: 1000,\n            boxShadow: 'var(--box-shadow, 0 1px 4px rgba(0,0,0,0.06))',\n          }}\n        >\n          {isMobile && (\n            <>\n              <Button\n                type=\"text\"\n                icon={<MenuOutlined style={{ color: token.colorText }} />}\n                onClick={() => setDrawerOpen(true)}\n              />\n              <Drawer\n                open={drawerOpen}\n                onClose={() => setDrawerOpen(false)}\n                placement=\"left\"\n                bodyStyle={{ padding: 0 }}\n              >\n                {menu}\n              </Drawer>\n            </>\n          )}\n        </Header>\n        <Content style={{ margin: '12px 16px' }}>\n          <Outlet />\n        </Content>\n      </Layout>\n    </Layout>\n  );\n}\n","size_bytes":3869},"src/pages/student/StudentRecords.tsx":{"content":"import { useEffect, useState } from 'react';\nimport {\n  Button,\n  Card,\n  Table,\n  Typography,\n  Space,\n  Select,\n  Divider,\n  Spin,\n  Alert,\n  DatePicker,\n} from 'antd';\nimport dayjs, { Dayjs } from 'dayjs';\nimport { useNavigate } from 'react-router-dom';\nimport BackButton from '../../components/BackButton';\nimport { getMyAttendanceRecords, getMyClass } from '../../api/student';\n\ntype AttendanceRecord = {\n  _id: string;\n  date: string;\n  status: 'Present' | 'Absent';\n  subject?: string | { name: string; subjectCode?: string };\n  teacher?: string | { name: string };\n  markedBy?: string | { name: string };\n  room?: string;\n};\n\nexport default function StudentRecords() {\n  const navigate = useNavigate();\n  const [records, setRecords] = useState<AttendanceRecord[]>([]);\n  const [subjects, setSubjects] = useState<string[]>([]);\n  const [selectedSubject, setSelectedSubject] = useState<string | null>(null);\n  const [selectedDate, setSelectedDate] = useState<Dayjs | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n  const [statusFilter, setStatusFilter] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const data = await getMyAttendanceRecords({ subjectId: '', date: '' });\n        const allRecords = data.records || [];\n        setRecords(allRecords);\n\n        // Extract unique subjects\n        const uniqueSubjects = Array.from(\n          new Set(\n            allRecords\n              .map((r: any) => r.subject?.name || r.subject)\n              .filter(Boolean)\n          )\n        ) as string[];\n        setSubjects(uniqueSubjects);\n\n        setErr(null);\n      } catch (e: any) {\n        setErr(\n          e?.response?.data?.message || e?.message || 'Failed to load records'\n        );\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, []);\n\n  // Filter and sort records\n  const processedRecords = records\n    .filter((r) => {\n      if (selectedSubject) {\n        const recordSubject =\n          typeof r.subject === 'string' ? r.subject : r.subject?.name;\n        if (recordSubject !== selectedSubject) return false;\n      }\n      if (selectedDate) {\n        const recordDate = dayjs(r.date).format('YYYY-MM-DD');\n        const filterDate = selectedDate.format('YYYY-MM-DD');\n        if (recordDate !== filterDate) return false;\n      }\n      if (statusFilter && r.status !== statusFilter) return false;\n      return true;\n    })\n    .sort((a, b) => {\n      const dateA = new Date(a.date).getTime();\n      const dateB = new Date(b.date).getTime();\n      return sortOrder === 'asc' ? dateA - dateB : dateB - dateA;\n    });\n\n  const columns = [\n    {\n      title: 'Date',\n      dataIndex: 'date',\n      key: 'date',\n      render: (date: string) => new Date(date).toLocaleDateString(),\n      width: 100,\n    },\n    {\n      title: 'Subject',\n      dataIndex: 'subject',\n      key: 'subject',\n      width: 150,\n      render: (subject: any) =>\n        typeof subject === 'string' ? subject : subject?.name,\n    },\n    {\n      title: 'Teacher',\n      dataIndex: 'markedBy',\n      key: 'markedBy',\n      width: 120,\n      render: (teacher: any) =>\n        typeof teacher === 'string' ? teacher : teacher?.name,\n    },\n    {\n      title: 'Status',\n      dataIndex: 'status',\n      key: 'status',\n      width: 80,\n      render: (status: string) => (\n        <span\n          style={{\n            padding: '4px 8px',\n            borderRadius: '4px',\n            backgroundColor: status === 'Present' ? '#dcfce7' : '#fee2e2',\n            color: status === 'Present' ? '#166534' : '#991b1b',\n            fontWeight: 600,\n          }}\n        >\n          {status}\n        </span>\n      ),\n    },\n  ];\n\n  if (loading) return <Spin />;\n  if (err)\n    return <Alert type=\"error\" message={err} style={{ marginBottom: 16 }} />;\n\n  return (\n    <div>\n      <BackButton />\n      <Typography.Title level={3}>Attendance Records</Typography.Title>\n\n      <Card style={{ marginBottom: 16 }}>\n        <Space direction=\"vertical\" style={{ width: '100%' }} size=\"large\">\n          <div\n            style={{\n              display: 'flex',\n              gap: 12,\n              justifyContent: 'space-between',\n              flexWrap: 'wrap',\n              alignItems: 'center',\n            }}\n          >\n            <Typography.Text>\n              Total: <strong>{processedRecords.length}</strong> | Present:{' '}\n              <strong style={{ color: '#166534' }}>\n                {processedRecords.filter((r) => r.status === 'Present').length}\n              </strong>{' '}\n              | Absent:{' '}\n              <strong style={{ color: '#991b1b' }}>\n                {processedRecords.filter((r) => r.status === 'Absent').length}\n              </strong>\n            </Typography.Text>\n\n            <Space wrap>\n              <DatePicker\n                placeholder=\"Select Date\"\n                value={selectedDate}\n                onChange={(date) => setSelectedDate(date)}\n                style={{\n                  borderRadius: '4px',\n                }}\n              />\n\n              <Select\n                allowClear\n                placeholder=\"All Subjects\"\n                style={{ width: 150 }}\n                value={selectedSubject}\n                onChange={(val) => setSelectedSubject(val)}\n                options={subjects.map((s) => ({ label: s, value: s }))}\n              />\n\n              <select\n                style={{\n                  padding: '4px 8px',\n                  borderRadius: '4px',\n                  border: '1px solid var(--border)',\n                  backgroundColor: 'var(--card)',\n                  color: 'var(--text)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                }}\n                value={sortOrder}\n                onChange={(e) => setSortOrder(e.target.value as 'asc' | 'desc')}\n              >\n                <option value=\"desc\">Newest First</option>\n                <option value=\"asc\">Oldest First</option>\n              </select>\n\n              <select\n                style={{\n                  padding: '4px 8px',\n                  borderRadius: '4px',\n                  border: '1px solid var(--border)',\n                  backgroundColor: 'var(--card)',\n                  color: 'var(--text)',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                }}\n                value={statusFilter || ''}\n                onChange={(e) => setStatusFilter(e.target.value || null)}\n              >\n                <option value=\"\">All Status</option>\n                <option value=\"Present\">Present</option>\n                <option value=\"Absent\">Absent</option>\n              </select>\n            </Space>\n          </div>\n\n          <Divider />\n\n          <Table\n            columns={columns}\n            dataSource={processedRecords.map((r, idx) => ({ ...r, key: idx }))}\n            pagination={{ pageSize: 20 }}\n            scroll={{ x: 600 }}\n          />\n        </Space>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7125},"src/vite-env.d.ts":{"content":"/// <reference types=\"vite/client\" />\n\ninterface ImportMetaEnv {\n  readonly VITE_API_BASE?: string;\n}\n\ninterface ImportMeta {\n  readonly env: ImportMetaEnv;\n}\n","size_bytes":159},"replit.md":{"content":"# AI Attendance System - Frontend\n\n## Overview\nThis is a React + TypeScript + Vite frontend application for an AI-powered attendance management system. The application provides different dashboards for administrators, teachers, and students to manage and track attendance records.\n\n## Project Architecture\n- **Framework**: React 18 with TypeScript\n- **Build Tool**: Vite 5\n- **UI Library**: Ant Design (antd)\n- **Routing**: React Router v6\n- **HTTP Client**: Axios\n- **State Management**: React Context API\n\n## Structure\n- `/src/pages/` - Page components organized by role (admin, teacher, student)\n- `/src/components/` - Reusable UI components\n- `/src/api/` - API client functions for backend communication\n- `/src/auth/` - Authentication context and logic\n- `/src/layouts/` - Layout components for different user roles\n- `/src/router/` - Application routing configuration\n- `/src/theme/` - Theme provider and customization\n- `/public/` - Static assets including service worker\n\n## User Roles\n1. **Admin** - Manages teachers, students, rooms, subjects, and classes\n2. **Teacher** - Marks attendance, views records, and generates summaries\n3. **Student** - Views personal attendance records and summaries\n\n## Backend Integration\nThe frontend expects a backend API to be available. The application makes API calls to endpoints like:\n- `/api/admin/*` - Admin operations\n- `/api/teacher/*` - Teacher operations\n- `/api/student/*` - Student operations\n\nNote: This is a frontend-only repository. The backend is expected to be running separately (typically on a different server/port).\n\n## Recent Changes (Setup for Replit)\n- Configured Vite to run on port 5000 with host 0.0.0.0\n- Added HMR configuration for Replit's proxy environment\n- Removed backend proxy configuration (backend runs separately)\n- Updated .gitignore for proper exclusions\n- Created TypeScript environment definitions for Vite\n\n## Development\n- **Dev Server**: Runs on `0.0.0.0:5000`\n- **Build Command**: `npm run build`\n- **Preview**: `npm run preview`\n\n## Features\n- JWT-based authentication with token storage\n- Role-based routing and access control\n- Service worker for offline functionality\n- Responsive UI with Ant Design components\n- Real-time room streaming for attendance monitoring\n","size_bytes":2257}},"version":2}